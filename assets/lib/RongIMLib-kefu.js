var Polling={SearchMpInput:function(){var e={};this.setType=function(t){e.type=t},this.setId=function(t){e.id=t},this.toArrayBuffer=function(){return e}},SearchMpOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},MpInfo:function(){var e={};this.setMpid=function(t){e.mpid=t},this.setName=function(t){e.name=t},this.setType=function(t){e.type=t},this.setTime=function(t){e.time=t},this.setPortraitUri=function(t){e.portraitUrl=t},this.setExtra=function(t){e.extra=t},this.toArrayBuffer=function(){return e}},PullMpInput:function(){var e={};this.setMpid=function(t){e.mpid=t},this.setTime=function(t){e.time=t},this.toArrayBuffer=function(){return e}},PullMpOutput:function(){var e={};this.setStatus=function(t){e.status=t},this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},MPFollowInput:function(){var e={};this.setId=function(t){e.id=t},this.toArrayBuffer=function(){return e}},MPFollowOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},NotifyMsg:function(){var e={};this.setType=function(t){e.type=t},this.setTime=function(t){e.time=t},this.setChrmId=function(t){e.chrmId=t},this.toArrayBuffer=function(){return e}},SyncRequestMsg:function(){var e={};this.setSyncTime=function(t){e.syncTime=t||0},this.setIspolling=function(t){e.ispolling=!!t},this.setIsweb=function(t){e.isweb=!!t},this.setIsPullSend=function(t){e.isPullSend=!!t},this.toArrayBuffer=function(){return e}},UpStreamMessage:function(){var e={};this.setSessionId=function(t){e.sessionId=t},this.setClassname=function(t){e.classname=t},this.setContent=function(t){t&&(e.content=t)},this.setPushText=function(t){e.pushText=t},this.toArrayBuffer=function(){return e}},DownStreamMessages:function(){var e={};this.setList=function(t){e.list=t},this.setSyncTime=function(t){e.syncTime=t},this.toArrayBuffer=function(){return e}},DownStreamMessage:function(){var e={};this.setFromUserId=function(t){e.fromUserId=t},this.setType=function(t){e.type=t},this.setGroupId=function(t){e.groupId=t},this.setClassname=function(t){e.classname=t},this.setContent=function(t){t&&(e.content=t)},this.setDataTime=function(t){e.dataTime=t},this.setStatus=function(t){e.status=t},this.setMsgId=function(t){e.msgId=t},this.toArrayBuffer=function(){return e}},CreateDiscussionInput:function(){var e={};this.setName=function(t){e.name=t},this.toArrayBuffer=function(){return e}},CreateDiscussionOutput:function(){var e={};this.setId=function(t){e.id=t},this.toArrayBuffer=function(){return e}},ChannelInvitationInput:function(){var e={};this.setUsers=function(t){e.users=t},this.toArrayBuffer=function(){return e}},LeaveChannelInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},QueryChatroomInfoInput:function(){var e={};this.setCount=function(t){e.count=t},this.setOrder=function(t){e.order=t},this.toArrayBuffer=function(){return e}},QueryChatroomInfoOutput:function(){var e={};this.setUserTotalNums=function(t){e.userTotalNums=t},this.setUserInfos=function(t){e.userInfos=t},this.toArrayBuffer=function(){return e}},ChannelEvictionInput:function(){var e={};this.setUser=function(t){e.user=t},this.toArrayBuffer=function(){return e}},RenameChannelInput:function(){var e={};this.setName=function(t){e.name=t},this.toArrayBuffer=function(){return e}},ChannelInfoInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},ChannelInfoOutput:function(){var e={};this.setType=function(t){e.type=t},this.setChannelId=function(t){e.channelId=t},this.setChannelName=function(t){e.channelName=t},this.setAdminUserId=function(t){e.adminUserId=t},this.setFirstTenUserIds=function(t){e.firstTenUserIds=t},this.setOpenStatus=function(t){e.openStatus=t},this.toArrayBuffer=function(){return e}},ChannelInfosInput:function(){var e={};this.setPage=function(t){e.page=t},this.setNumber=function(t){e.number=t},this.toArrayBuffer=function(){return e}},ChannelInfosOutput:function(){var e={};this.setChannels=function(t){e.channels=t},this.setTotal=function(t){e.total=t},this.toArrayBuffer=function(){return e}},MemberInfo:function(){var e={};this.setUserId=function(t){e.userId=t},this.setUserName=function(t){e.userName=t},this.setUserPortrait=function(t){e.userPortrait=t},this.setExtension=function(t){e.extension=t},this.toArrayBuffer=function(){return e}},GroupMembersInput:function(){var e={};this.setPage=function(t){e.page=t},this.setNumber=function(t){e.number=t},this.toArrayBuffer=function(){return e}},GroupMembersOutput:function(){var e={};this.setMembers=function(t){e.members=t},this.setTotal=function(t){e.total=t},this.toArrayBuffer=function(){return e}},GetUserInfoInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},GetUserInfoOutput:function(){var e={};this.setUserId=function(t){e.userId=t},this.setUserName=function(t){e.userName=t},this.setUserPortrait=function(t){e.userPortrait=t},this.toArrayBuffer=function(){return e}},GetSessionIdInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},GetSessionIdOutput:function(){var e={};this.setSessionId=function(t){e.sessionId=t},this.toArrayBuffer=function(){return e}},GetQNupTokenInput:function(){var e={};this.setType=function(t){e.type=t},this.toArrayBuffer=function(){return e}},GetQNupTokenOutput:function(){var e={};this.setDeadline=function(t){e.deadline=t},this.setToken=function(t){e.token=t},this.toArrayBuffer=function(){return e}},GetQNdownloadUrlInput:function(){var e={};this.setType=function(t){e.type=t},this.setKey=function(t){e.key=t},this.toArrayBuffer=function(){return e}},GetQNdownloadUrlOutput:function(){var e={};this.setDownloadUrl=function(t){e.downloadUrl=t},this.toArrayBuffer=function(){return e}},Add2BlackListInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.toArrayBuffer=function(){return e}},RemoveFromBlackListInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.toArrayBuffer=function(){return e}},QueryBlackListInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},QueryBlackListOutput:function(){var e={};this.setUserIds=function(t){e.userIds=t},this.toArrayBuffer=function(){return e}},BlackListStatusInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.toArrayBuffer=function(){return e}},BlockPushInput:function(){var e={};this.setBlockeeId=function(t){e.blockeeId=t},this.toArrayBuffer=function(){return e}},ModifyPermissionInput:function(){var e={};this.setOpenStatus=function(t){e.openStatus=t},this.toArrayBuffer=function(){return e}},GroupInput:function(){var e={};this.setGroupInfo=function(t){for(var n=0,o=[];n<t.length;n++)o.push({id:t[n].getContent().id,name:t[n].getContent().name});e.groupInfo=o},this.toArrayBuffer=function(){return e}},GroupOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},GroupInfo:function(){var e={};this.setId=function(t){e.id=t},this.setName=function(t){e.name=t},this.getContent=function(){return e},this.toArrayBuffer=function(){return e}},GroupHashInput:function(){var e={};this.setUserId=function(t){e.userId=t},this.setGroupHashCode=function(t){e.groupHashCode=t},this.toArrayBuffer=function(){return e}},GroupHashOutput:function(){var e={};this.setResult=function(t){e.result=t},this.toArrayBuffer=function(){return e}},ChrmInput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},ChrmOutput:function(){var e={};this.setNothing=function(t){e.nothing=t},this.toArrayBuffer=function(){return e}},ChrmPullMsg:function(){var e={};this.setSyncTime=function(t){e.syncTime=t},this.setCount=function(t){e.count=t},this.toArrayBuffer=function(){return e}},RelationsInput:function(){var e={};this.setType=function(t){e.type=t},this.setMsg=function(t){e.msg=t},this.toArrayBuffer=function(){return e}},RelationsOutput:function(){var e={};this.setInfo=function(t){e.info=t},this.toArrayBuffer=function(){return e}},RelationInfo:function(){var e={};this.setType=function(t){e.type=t},this.setUserId=function(t){e.userId=t},this.setMsg=function(t){e.msg=t},this.toArrayBuffer=function(){return e}},HistoryMessageInput:function(){var e={};this.setTargetId=function(t){e.targetId=t},this.setDataTime=function(t){e.dataTime=t},this.setSize=function(t){e.size=t},this.toArrayBuffer=function(){return e}},HistoryMessagesOuput:function(){var e={};this.setList=function(t){e.list=t},this.setSyncTime=function(t){e.syncTime=t},this.setHasMsg=function(t){e.hasMsg=t},this.toArrayBuffer=function(){return e}}};for(var f in Polling)Polling[f].decode=function(b){var back={},val=JSON.parse(b)||eval("("+b+")");for(var i in val)back[i]=val[i],back["get"+i.charAt(0).toUpperCase()+i.slice(1)]=function(){return val[i]};return back};!function(e){function t(e,t){var n=(65535&e)+(65535&t),o=(e>>16)+(t>>16)+(n>>16);return o<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function o(e,o,s,r,i,a){return t(n(t(t(o,e),t(r,a)),i),s)}function s(e,t,n,s,r,i,a){return o(t&n|~t&s,e,t,r,i,a)}function r(e,t,n,s,r,i,a){return o(t&s|n&~s,e,t,r,i,a)}function i(e,t,n,s,r,i,a){return o(t^n^s,e,t,r,i,a)}function a(e,t,n,s,r,i,a){return o(n^(t|~s),e,t,r,i,a)}function c(e,n){e[n>>5]|=128<<n%32,e[(n+64>>>9<<4)+14]=n;var o,c,u,g,p,h=1732584193,d=-271733879,f=-1732584194,l=271733878;for(o=0;o<e.length;o+=16)c=h,u=d,g=f,p=l,h=s(h,d,f,l,e[o],7,-680876936),l=s(l,h,d,f,e[o+1],12,-389564586),f=s(f,l,h,d,e[o+2],17,606105819),d=s(d,f,l,h,e[o+3],22,-1044525330),h=s(h,d,f,l,e[o+4],7,-176418897),l=s(l,h,d,f,e[o+5],12,1200080426),f=s(f,l,h,d,e[o+6],17,-1473231341),d=s(d,f,l,h,e[o+7],22,-45705983),h=s(h,d,f,l,e[o+8],7,1770035416),l=s(l,h,d,f,e[o+9],12,-1958414417),f=s(f,l,h,d,e[o+10],17,-42063),d=s(d,f,l,h,e[o+11],22,-1990404162),h=s(h,d,f,l,e[o+12],7,1804603682),l=s(l,h,d,f,e[o+13],12,-40341101),f=s(f,l,h,d,e[o+14],17,-1502002290),d=s(d,f,l,h,e[o+15],22,1236535329),h=r(h,d,f,l,e[o+1],5,-165796510),l=r(l,h,d,f,e[o+6],9,-1069501632),f=r(f,l,h,d,e[o+11],14,643717713),d=r(d,f,l,h,e[o],20,-373897302),h=r(h,d,f,l,e[o+5],5,-701558691),l=r(l,h,d,f,e[o+10],9,38016083),f=r(f,l,h,d,e[o+15],14,-660478335),d=r(d,f,l,h,e[o+4],20,-405537848),h=r(h,d,f,l,e[o+9],5,568446438),l=r(l,h,d,f,e[o+14],9,-1019803690),f=r(f,l,h,d,e[o+3],14,-187363961),d=r(d,f,l,h,e[o+8],20,1163531501),h=r(h,d,f,l,e[o+13],5,-1444681467),l=r(l,h,d,f,e[o+2],9,-51403784),f=r(f,l,h,d,e[o+7],14,1735328473),d=r(d,f,l,h,e[o+12],20,-1926607734),h=i(h,d,f,l,e[o+5],4,-378558),l=i(l,h,d,f,e[o+8],11,-2022574463),f=i(f,l,h,d,e[o+11],16,1839030562),d=i(d,f,l,h,e[o+14],23,-35309556),h=i(h,d,f,l,e[o+1],4,-1530992060),l=i(l,h,d,f,e[o+4],11,1272893353),f=i(f,l,h,d,e[o+7],16,-155497632),d=i(d,f,l,h,e[o+10],23,-1094730640),h=i(h,d,f,l,e[o+13],4,681279174),l=i(l,h,d,f,e[o],11,-358537222),f=i(f,l,h,d,e[o+3],16,-722521979),d=i(d,f,l,h,e[o+6],23,76029189),h=i(h,d,f,l,e[o+9],4,-640364487),l=i(l,h,d,f,e[o+12],11,-421815835),f=i(f,l,h,d,e[o+15],16,530742520),d=i(d,f,l,h,e[o+2],23,-995338651),h=a(h,d,f,l,e[o],6,-198630844),l=a(l,h,d,f,e[o+7],10,1126891415),f=a(f,l,h,d,e[o+14],15,-1416354905),d=a(d,f,l,h,e[o+5],21,-57434055),h=a(h,d,f,l,e[o+12],6,1700485571),l=a(l,h,d,f,e[o+3],10,-1894986606),f=a(f,l,h,d,e[o+10],15,-1051523),d=a(d,f,l,h,e[o+1],21,-2054922799),h=a(h,d,f,l,e[o+8],6,1873313359),l=a(l,h,d,f,e[o+15],10,-30611744),f=a(f,l,h,d,e[o+6],15,-1560198380),d=a(d,f,l,h,e[o+13],21,1309151649),h=a(h,d,f,l,e[o+4],6,-145523070),l=a(l,h,d,f,e[o+11],10,-1120210379),f=a(f,l,h,d,e[o+2],15,718787259),d=a(d,f,l,h,e[o+9],21,-343485551),h=t(h,c),d=t(d,u),f=t(f,g),l=t(l,p);return[h,d,f,l]}function u(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function g(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function p(e){return u(c(g(e),8*e.length))}function h(e,t){var n,o,s=g(e),r=[],i=[];for(r[15]=i[15]=void 0,s.length>16&&(s=c(s,8*e.length)),n=0;16>n;n+=1)r[n]=909522486^s[n],i[n]=1549556828^s[n];return o=c(r.concat(g(t)),512+8*t.length),u(c(i.concat(o),640))}function d(e){var t,n,o="0123456789abcdef",s="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),s+=o.charAt(t>>>4&15)+o.charAt(15&t);return s}function f(e){return unescape(encodeURIComponent(e))}function l(e){return p(f(e))}function m(e){return d(l(e))}function I(e,t){return h(f(e),f(t))}function y(e,t){return d(I(e,t))}function C(e,t,n){return t?n?I(t,e):y(t,e):n?l(e):m(e)}e.md5=C,"function"==typeof define&&define.amd?define("md5",function(){return C}):"object"==typeof module&&module.exports?module.exports=C:e.md5=C}(this);var RongIMLib;!function(e){!function(e){e[e.IN_BLACK_LIST=0]="IN_BLACK_LIST",e[e.NOT_IN_BLACK_LIST=1]="NOT_IN_BLACK_LIST"}(e.BlacklistStatus||(e.BlacklistStatus={}));e.BlacklistStatus;!function(e){e[e.XHR_POLLING=0]="XHR_POLLING",e[e.WEBSOCKET=1]="WEBSOCKET",e[e.HTTP=0]="HTTP",e[e.HTTPS=1]="HTTPS"}(e.ConnectionChannel||(e.ConnectionChannel={}));e.ConnectionChannel;!function(e){e[e.ONLY_ROBOT=1]="ONLY_ROBOT",e[e.ONLY_HUMAN=2]="ONLY_HUMAN",e[e.ROBOT_FIRST=3]="ROBOT_FIRST",e[e.HUMAN_FIRST=4]="HUMAN_FIRST"}(e.CustomerType||(e.CustomerType={}));e.CustomerType;!function(e){e[e.NONE=0]="NONE",e[e.SQQUENCE=1]="SQQUENCE",e[e.REVERSE=2]="REVERSE"}(e.GetChatRoomType||(e.GetChatRoomType={}));e.GetChatRoomType;!function(e){e[e.CONNECTED=0]="CONNECTED",e[e.CONNECTING=1]="CONNECTING",e[e.DISCONNECTED=2]="DISCONNECTED",e[e.KICKED_OFFLINE_BY_OTHER_CLIENT=6]="KICKED_OFFLINE_BY_OTHER_CLIENT",e[e.NETWORK_UNAVAILABLE=3]="NETWORK_UNAVAILABLE",e[e.DOMAIN_INCORRECT=12]="DOMAIN_INCORRECT"}(e.ConnectionStatus||(e.ConnectionStatus={}));e.ConnectionStatus;!function(e){e[e.DO_NOT_DISTURB=0]="DO_NOT_DISTURB",e[e.NOTIFY=1]="NOTIFY"}(e.ConversationNotificationStatus||(e.ConversationNotificationStatus={}));e.ConversationNotificationStatus;!function(e){e[e.NONE=0]="NONE",e[e.PRIVATE=1]="PRIVATE",e[e.DISCUSSION=2]="DISCUSSION",e[e.GROUP=3]="GROUP",e[e.CHATROOM=4]="CHATROOM",e[e.CUSTOMER_SERVICE=5]="CUSTOMER_SERVICE",e[e.SYSTEM=6]="SYSTEM",e[e.APP_PUBLIC_SERVICE=7]="APP_PUBLIC_SERVICE",e[e.PUBLIC_SERVICE=8]="PUBLIC_SERVICE"}(e.ConversationType||(e.ConversationType={}));e.ConversationType;!function(e){e[e.OPENED=0]="OPENED",e[e.CLOSED=1]="CLOSED"}(e.DiscussionInviteStatus||(e.DiscussionInviteStatus={}));e.DiscussionInviteStatus;!function(e){e[e.TIMEOUT=-1]="TIMEOUT",e[e.UNKNOWN=-2]="UNKNOWN",e[e.SEND_FREQUENCY_TOO_FAST=20604]="SEND_FREQUENCY_TOO_FAST",e[e.NOT_IN_DISCUSSION=21406]="NOT_IN_DISCUSSION",e[e.JOIN_IN_DISCUSSION=21407]="JOIN_IN_DISCUSSION",e[e.CREATE_DISCUSSION=21408]="CREATE_DISCUSSION",e[e.INVITE_DICUSSION=21409]="INVITE_DICUSSION",e[e.NOT_IN_GROUP=22406]="NOT_IN_GROUP",e[e.NOT_IN_CHATROOM=23406]="NOT_IN_CHATROOM",e[e.GET_USERINFO_ERROR=23407]="GET_USERINFO_ERROR",e[e.FORBIDDEN_IN_CHATROOM=23408]="FORBIDDEN_IN_CHATROOM",e[e.REJECTED_BY_BLACKLIST=405]="REJECTED_BY_BLACKLIST",e[e.RC_NET_CHANNEL_INVALID=30001]="RC_NET_CHANNEL_INVALID",e[e.RC_NET_UNAVAILABLE=30002]="RC_NET_UNAVAILABLE",e[e.RC_MSG_RESP_TIMEOUT=30003]="RC_MSG_RESP_TIMEOUT",e[e.RC_HTTP_SEND_FAIL=30004]="RC_HTTP_SEND_FAIL",e[e.RC_HTTP_REQ_TIMEOUT=30005]="RC_HTTP_REQ_TIMEOUT",e[e.RC_HTTP_RECV_FAIL=30006]="RC_HTTP_RECV_FAIL",e[e.RC_NAVI_RESOURCE_ERROR=30007]="RC_NAVI_RESOURCE_ERROR",e[e.RC_NODE_NOT_FOUND=30008]="RC_NODE_NOT_FOUND",e[e.RC_DOMAIN_NOT_RESOLVE=30009]="RC_DOMAIN_NOT_RESOLVE",e[e.RC_SOCKET_NOT_CREATED=30010]="RC_SOCKET_NOT_CREATED",e[e.RC_SOCKET_DISCONNECTED=30011]="RC_SOCKET_DISCONNECTED",e[e.RC_PING_SEND_FAIL=30012]="RC_PING_SEND_FAIL",e[e.RC_PONG_RECV_FAIL=30013]="RC_PONG_RECV_FAIL",e[e.RC_MSG_SEND_FAIL=30014]="RC_MSG_SEND_FAIL",e[e.RC_CONN_ACK_TIMEOUT=31e3]="RC_CONN_ACK_TIMEOUT",e[e.RC_CONN_PROTO_VERSION_ERROR=31001]="RC_CONN_PROTO_VERSION_ERROR",e[e.RC_CONN_ID_REJECT=31002]="RC_CONN_ID_REJECT",e[e.RC_CONN_SERVER_UNAVAILABLE=31003]="RC_CONN_SERVER_UNAVAILABLE",e[e.RC_CONN_USER_OR_PASSWD_ERROR=31004]="RC_CONN_USER_OR_PASSWD_ERROR",e[e.RC_CONN_NOT_AUTHRORIZED=31005]="RC_CONN_NOT_AUTHRORIZED",e[e.RC_CONN_REDIRECTED=31006]="RC_CONN_REDIRECTED",e[e.RC_CONN_PACKAGE_NAME_INVALID=31007]="RC_CONN_PACKAGE_NAME_INVALID",e[e.RC_CONN_APP_BLOCKED_OR_DELETED=31008]="RC_CONN_APP_BLOCKED_OR_DELETED",e[e.RC_CONN_USER_BLOCKED=31009]="RC_CONN_USER_BLOCKED",e[e.RC_DISCONN_KICK=31010]="RC_DISCONN_KICK",e[e.RC_DISCONN_EXCEPTION=31011]="RC_DISCONN_EXCEPTION",e[e.RC_QUERY_ACK_NO_DATA=32001]="RC_QUERY_ACK_NO_DATA",e[e.RC_MSG_DATA_INCOMPLETE=32002]="RC_MSG_DATA_INCOMPLETE",e[e.BIZ_ERROR_CLIENT_NOT_INIT=33001]="BIZ_ERROR_CLIENT_NOT_INIT",e[e.BIZ_ERROR_DATABASE_ERROR=33002]="BIZ_ERROR_DATABASE_ERROR",e[e.BIZ_ERROR_INVALID_PARAMETER=33003]="BIZ_ERROR_INVALID_PARAMETER",e[e.BIZ_ERROR_NO_CHANNEL=33004]="BIZ_ERROR_NO_CHANNEL",e[e.BIZ_ERROR_RECONNECT_SUCCESS=33005]="BIZ_ERROR_RECONNECT_SUCCESS",e[e.BIZ_ERROR_CONNECTING=33006]="BIZ_ERROR_CONNECTING",e[e.MSG_ROAMING_SERVICE_UNAVAILABLE=33007]="MSG_ROAMING_SERVICE_UNAVAILABLE",e[e.FORBIDDEN_IN_GROUP=22408]="FORBIDDEN_IN_GROUP",e[e.CONVER_REMOVE_ERROR=34001]="CONVER_REMOVE_ERROR",e[e.CONVER_GETLIST_ERROR=34002]="CONVER_GETLIST_ERROR",e[e.CONVER_SETOP_ERROR=34003]="CONVER_SETOP_ERROR",e[e.CONVER_TOTAL_UNREAD_ERROR=34004]="CONVER_TOTAL_UNREAD_ERROR",e[e.CONVER_TYPE_UNREAD_ERROR=34005]="CONVER_TYPE_UNREAD_ERROR",e[e.CONVER_ID_TYPE_UNREAD_ERROR=34006]="CONVER_ID_TYPE_UNREAD_ERROR",e[e.GROUP_SYNC_ERROR=35001]="GROUP_SYNC_ERROR",e[e.GROUP_MATCH_ERROR=35002]="GROUP_MATCH_ERROR",e[e.CHATROOM_ID_ISNULL=36001]="CHATROOM_ID_ISNULL",e[e.CHARTOOM_JOIN_ERROR=36002]="CHARTOOM_JOIN_ERROR",e[e.CHATROOM_HISMESSAGE_ERROR=36003]="CHATROOM_HISMESSAGE_ERROR",e[e.BLACK_ADD_ERROR=37001]="BLACK_ADD_ERROR",e[e.BLACK_GETSTATUS_ERROR=37002]="BLACK_GETSTATUS_ERROR",e[e.BLACK_REMOVE_ERROR=37003]="BLACK_REMOVE_ERROR",e[e.DRAF_GET_ERROR=38001]="DRAF_GET_ERROR",e[e.DRAF_SAVE_ERROR=38002]="DRAF_SAVE_ERROR",e[e.DRAF_REMOVE_ERROR=38003]="DRAF_REMOVE_ERROR",e[e.SUBSCRIBE_ERROR=39001]="SUBSCRIBE_ERROR",e[e.QNTKN_FILETYPE_ERROR=41001]="QNTKN_FILETYPE_ERROR",e[e.QNTKN_GET_ERROR=41002]="QNTKN_GET_ERROR",e[e.COOKIE_ENABLE=51001]="COOKIE_ENABLE"}(e.ErrorCode||(e.ErrorCode={}));e.ErrorCode;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO",e[e.FILE=100]="FILE"}(e.MediaType||(e.MediaType={}));e.MediaType;!function(e){e[e.SEND=1]="SEND",e[e.RECEIVE=2]="RECEIVE"}(e.MessageDirection||(e.MessageDirection={}));e.MessageDirection;!function(e){e[e.IMAGE=1]="IMAGE",e[e.AUDIO=2]="AUDIO",e[e.VIDEO=3]="VIDEO"}(e.FileType||(e.FileType={}));e.FileType;!function(e){e[e.RC_REAL_TIME_LOCATION_NOT_INIT=-1]="RC_REAL_TIME_LOCATION_NOT_INIT",e[e.RC_REAL_TIME_LOCATION_SUCCESS=0]="RC_REAL_TIME_LOCATION_SUCCESS",e[e.RC_REAL_TIME_LOCATION_GPS_DISABLED=1]="RC_REAL_TIME_LOCATION_GPS_DISABLED",e[e.RC_REAL_TIME_LOCATION_CONVERSATION_NOT_SUPPORT=2]="RC_REAL_TIME_LOCATION_CONVERSATION_NOT_SUPPORT",e[e.RC_REAL_TIME_LOCATION_IS_ON_GOING=3]="RC_REAL_TIME_LOCATION_IS_ON_GOING",e[e.RC_REAL_TIME_LOCATION_EXCEED_MAX_PARTICIPANT=4]="RC_REAL_TIME_LOCATION_EXCEED_MAX_PARTICIPANT",e[e.RC_REAL_TIME_LOCATION_JOIN_FAILURE=5]="RC_REAL_TIME_LOCATION_JOIN_FAILURE",e[e.RC_REAL_TIME_LOCATION_START_FAILURE=6]="RC_REAL_TIME_LOCATION_START_FAILURE",e[e.RC_REAL_TIME_LOCATION_NETWORK_UNAVAILABLE=7]="RC_REAL_TIME_LOCATION_NETWORK_UNAVAILABLE"}(e.RealTimeLocationErrorCode||(e.RealTimeLocationErrorCode={}));e.RealTimeLocationErrorCode;!function(e){e[e.RC_REAL_TIME_LOCATION_STATUS_IDLE=0]="RC_REAL_TIME_LOCATION_STATUS_IDLE",e[e.RC_REAL_TIME_LOCATION_STATUS_INCOMING=1]="RC_REAL_TIME_LOCATION_STATUS_INCOMING",e[e.RC_REAL_TIME_LOCATION_STATUS_OUTGOING=2]="RC_REAL_TIME_LOCATION_STATUS_OUTGOING",e[e.RC_REAL_TIME_LOCATION_STATUS_CONNECTED=3]="RC_REAL_TIME_LOCATION_STATUS_CONNECTED"}(e.RealTimeLocationStatus||(e.RealTimeLocationStatus={}));e.RealTimeLocationStatus;!function(e){e[e.READ=1]="READ",e[e.LISTENED=2]="LISTENED",e[e.DOWNLOADED=4]="DOWNLOADED",e[e.RETRIEVED=8]="RETRIEVED"}(e.ReceivedStatus||(e.ReceivedStatus={}));e.ReceivedStatus;!function(e){e[e.EXACT=0]="EXACT",e[e.FUZZY=1]="FUZZY"}(e.SearchType||(e.SearchType={}));e.SearchType;!function(e){e[e.SENDING=10]="SENDING",e[e.FAILED=20]="FAILED",e[e.SENT=30]="SENT",e[e.RECEIVED=40]="RECEIVED",e[e.READ=50]="READ",e[e.DESTROYED=60]="DESTROYED"}(e.SentStatus||(e.SentStatus={}));e.SentStatus;!function(e){e[e.ACCEPTED=0]="ACCEPTED",e[e.UNACCEPTABLE_PROTOCOL_VERSION=1]="UNACCEPTABLE_PROTOCOL_VERSION",e[e.IDENTIFIER_REJECTED=2]="IDENTIFIER_REJECTED",e[e.SERVER_UNAVAILABLE=3]="SERVER_UNAVAILABLE",e[e.TOKEN_INCORRECT=4]="TOKEN_INCORRECT",e[e.NOT_AUTHORIZED=5]="NOT_AUTHORIZED",e[e.REDIRECT=6]="REDIRECT",e[e.PACKAGE_ERROR=7]="PACKAGE_ERROR",e[e.APP_BLOCK_OR_DELETE=8]="APP_BLOCK_OR_DELETE",e[e.BLOCK=9]="BLOCK",e[e.TOKEN_EXPIRE=10]="TOKEN_EXPIRE",e[e.DEVICE_ERROR=11]="DEVICE_ERROR"}(e.ConnectionState||(e.ConnectionState={}));e.ConnectionState}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(){}return t.getInstance=function(){if(!t._instance)throw new Error("RongIMClient is not initialized. Call .init() method first.");return t._instance},t.init=function(n,o){if(t._instance||(t._instance=new t),"http"==window.SCHEMETYPE?t.schemeType=e.ConnectionChannel.HTTP:"https"==window.SCHEMETYPE?t.schemeType=e.ConnectionChannel.HTTPS:"http:"==document.location.protocol?t.schemeType=e.ConnectionChannel.HTTP:t.schemeType=e.ConnectionChannel.HTTPS,!window.WEB_XHR_POLLING){var s=(navigator.appName,navigator.appVersion),r=s.split(";");if(r.length>1){var i=parseInt(r[1].replace(/[ ]/g,"").replace(/MSIE/g,""));10>i&&(window.WEB_XHR_POLLING=!0)}}var a=new e.FeaturePatcher;a.patchAll(),t._memoryStore={token:"",callback:null,hasModules:!0,global:window,lastReadTime:new e.LimitableMap,conversationList:[],appKey:n,publicServiceMap:new e.PublicServiceMap,listenerList:[],providerType:1,deltaTime:0,filterMessages:[],isSyncRemoteConverList:!1,isUseWebSQLProvider:!1,otherDevice:!1,custStore:{},converStore:{}},t._cookieHelper=new e.CookieProvider,o&&"[object Object]"==Object.prototype.toString.call(o)?(t._dataAccessProvider=o,t._memoryStore.isUseWebSQLProvider=!0):t._dataAccessProvider=new e.ServerDataProvider,t.MessageParams={TextMessage:{objectName:"RC:TxtMsg",msgTag:new e.MessageTag(!0,!0)},ImageMessage:{objectName:"RC:ImgMsg",msgTag:new e.MessageTag(!0,!0)},DiscussionNotificationMessage:{objectName:"RC:DizNtf",msgTag:new e.MessageTag(!0,!0)},VoiceMessage:{objectName:"RC:VcMsg",msgTag:new e.MessageTag(!0,!0)},RichContentMessage:{objectName:"RC:ImgTextMsg",msgTag:new e.MessageTag(!0,!0)},HandshakeMessage:{objectName:"",msgTag:new e.MessageTag(!0,!0)},UnknownMessage:{objectName:"",msgTag:new e.MessageTag(!0,!0)},LocationMessage:{objectName:"RC:LBSMsg",msgTag:new e.MessageTag(!0,!0)},InformationNotificationMessage:{objectName:"RC:InfoNtf",msgTag:new e.MessageTag(!0,!0)},ContactNotificationMessage:{objectName:"RC:ContactNtf",msgTag:new e.MessageTag(!0,!0)},ProfileNotificationMessage:{objectName:"RC:ProfileNtf",msgTag:new e.MessageTag(!0,!0)},CommandNotificationMessage:{objectName:"RC:CmdNtf",msgTag:new e.MessageTag(!0,!0)},CommandMessage:{objectName:"RC:CmdMsg",msgTag:new e.MessageTag(!1,!1)},TypingStatusMessage:{objectName:"RC:TypSts",msgTag:new e.MessageTag(!1,!1)},ChangeModeResponseMessage:{objectName:"RC:CsChaR",msgTag:new e.MessageTag(!1,!1)},ChangeModeMessage:{objectName:"RC:CSCha",msgTag:new e.MessageTag(!1,!1)},EvaluateMessage:{objectName:"RC:CsEva",msgTag:new e.MessageTag(!1,!1)},HandShakeMessage:{objectName:"RC:CsHs",msgTag:new e.MessageTag(!1,!1)},HandShakeResponseMessage:{objectName:"RC:CsHsR",msgTag:new e.MessageTag(!1,!1)},SuspendMessage:{objectName:"RC:CsSp",msgTag:new e.MessageTag(!1,!1)},TerminateMessage:{objectName:"RC:CsEnd",msgTag:new e.MessageTag(!1,!1)},CustomerStatusUpdateMessage:{objectName:"RC:CsUpdate",msgTag:new e.MessageTag(!1,!1)},ReadReceiptMessage:{objectName:"RC:ReadNtf",msgTag:new e.MessageTag(!1,!1)}},t.MessageType={TextMessage:"TextMessage",ImageMessage:"ImageMessage",DiscussionNotificationMessage:"DiscussionNotificationMessage",VoiceMessage:"VoiceMessage",RichContentMessage:"RichContentMessage",HandshakeMessage:"HandshakeMessage",UnknownMessage:"UnknownMessage",LocationMessage:"LocationMessage",InformationNotificationMessage:"InformationNotificationMessage",ContactNotificationMessage:"ContactNotificationMessage",ProfileNotificationMessage:"ProfileNotificationMessage",CommandNotificationMessage:"CommandNotificationMessage",CommandMessage:"CommandMessage",TypingStatusMessage:"TypingStatusMessage",ChangeModeResponseMessage:"ChangeModeResponseMessage",ChangeModeMessage:"ChangeModeMessage",EvaluateMessage:"EvaluateMessage",HandShakeMessage:"HandShakeMessage",HandShakeResponseMessage:"HandShakeResponseMessage",SuspendMessage:"SuspendMessage",TerminateMessage:"TerminateMessage",CustomerStatusUpdateMessage:"CustomerStatusUpdateMessage"}},t.connect=function(n,o){if(e.CheckParam.getInstance().check(["string","object"],"connect",!0),t.bridge=e.Bridge.getInstance(),t._memoryStore.token=n,t._memoryStore.callback=o,!navigator.cookieEnabled)return void setTimeout(function(){o.onError(e.ErrorCode.COOKIE_ENABLE)});t.bridge.connect(t._memoryStore.appKey,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(t){t!=e.ConnectionState.TOKEN_INCORRECT&&t?setTimeout(function(){o.onError(t)}):setTimeout(function(){o.onTokenIncorrect()})}});for(var s=0,r=t._memoryStore.listenerList.length;r>s;s++)t.bridge.setListener(t._memoryStore.listenerList[s]);return t._memoryStore.listenerList.length=0,t._instance},t.reconnect=function(e){t.bridge.reconnect(e)},t.registerMessageType=function(n,o,s,r){if(!n)throw new Error("messageType can't be empty,postion -> registerMessageType");if(!o)throw new Error("objectName can't be empty,postion -> registerMessageType");if("[object Array]"==Object.prototype.toString.call(r)){var i=e.ModelUtil.modleCreate(r,n);t.RegisterMessage[n]=i}else{if("[object Function]"!=Object.prototype.toString.call(r)&&"[object Object]"!=Object.prototype.toString.call(r))throw new Error("The index of 3 parameter was wrong type  must be object or function or array-> registerMessageType");if(!r.encode)throw new Error("encode method has not realized or messageName is undefined-> registerMessageType");if(!r.decode)throw new Error("decode method has not realized -> registerMessageType")}t.RegisterMessage[n].messageName=n,t.MessageType[n]=n,t.MessageParams[n]={objectName:o,msgTag:s},registerMessageTypeMapping[o]=n},t.setConnectionStatusListener=function(e){t.bridge?t.bridge.setListener(e):t._memoryStore.listenerList.push(e)},t.setOnReceiveMessageListener=function(e){t.bridge?t.bridge.setListener(e):t._memoryStore.listenerList.push(e)},t.prototype.logout=function(){t.bridge.disconnect(),t.bridge=null},t.prototype.disconnect=function(){t.bridge.disconnect()},t.prototype.startCustomService=function(n,o){if(n&&o){var s=new e.HandShakeMessage,r=this;t.getInstance().sendMessage(e.ConversationType.CUSTOMER_SERVICE,n,s,{onSuccess:function(e){e.isBlack?(o.onError(),r.stopCustomeService(n,{onSuccess:function(){},onError:function(){}})):(t._memoryStore.custStore[n]=e,o.onSuccess())},onError:function(){o.onError()}})}},t.prototype.stopCustomeService=function(n,o){if(n&&o){var s=t._memoryStore.custStore[n];if(s){var r=new e.SuspendMessage({sid:s.sid,uid:s.uid,pid:s.pid});this.sendCustMessage(n,r,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(){setTimeout(function(){o.onError()})}})}}},t.prototype.switchToHumanMode=function(n,o){if(n&&o){var s=t._memoryStore.custStore[n];if(s){var r=new e.ChangeModeMessage({sid:s.sid,uid:s.uid,pid:s.pid});this.sendCustMessage(n,r,o)}}},t.prototype.evaluateRebotCustomService=function(n,o,s,r){if(n&&r){var i=t._memoryStore.custStore[n];if(i){var a=new e.EvaluateMessage({sid:i.sid,uid:i.uid,pid:i.pid,isRobotResolved:o,sugest:s,type:0});this.sendCustMessage(n,a,r)}}},t.prototype.evaluateHumanCustomService=function(n,o,s,r){if(n&&r){var i=t._memoryStore.custStore[n];if(i){var a=new e.EvaluateMessage({sid:i.sid,uid:i.uid,pid:i.pid,humanValue:o,sugest:s,type:1});this.sendCustMessage(n,a,r)}}},t.prototype.sendCustMessage=function(n,o,s){t.getInstance().sendMessage(e.ConversationType.CUSTOMER_SERVICE,n,o,{onSuccess:function(e){s.onSuccess()},onError:function(){s.onError()}})},t.prototype.getCurrentConnectionStatus=function(){return e.Bridge._client.channel.connectionStatus},t.prototype.getConnectionChannel=function(){return e.Transportations._TransportType==e.Socket.XHR_POLLING?e.ConnectionChannel.XHR_POLLING:e.Transportations._TransportType==e.Socket.WEBSOCKET?e.ConnectionChannel.WEBSOCKET:void 0},t.prototype.getStorageProvider=function(){return 1==t._memoryStore.providerType?"ServerDataProvider":"OtherDataProvider"},t.prototype.setFilterMessages=function(e){"[object Array]"==Object.prototype.toString.call(e)&&(t._memoryStore.filterMessages=e)},t.prototype.getCurrentUserId=function(){return e.Bridge._client.userId},t.prototype.getDeltaTime=function(){return t._memoryStore.deltaTime},t.prototype.getMessage=function(e,n){t._dataAccessProvider.getMessage(e,n)},t.prototype.deleteLocalMessages=function(e,n,o,s){t._dataAccessProvider.removeLocalMessage(e,n,o,s)},t.prototype.updateMessage=function(e,n){t._dataAccessProvider.updateMessage(e,n)},t.prototype.clearMessages=function(e,n,o){t._dataAccessProvider.clearMessages(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.clearMessagesUnreadStatus=function(e,n,o){t._dataAccessProvider.updateMessages(e,n,"readStatus",null,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.deleteMessages=function(e,n,o,s){t._dataAccessProvider.removeMessage(e,n,o,{onSuccess:function(e){setTimeout(function(){s.onSuccess(e)})},onError:function(e){setTimeout(function(){s.onError(e)})}})},t.prototype.sendLocalMessage=function(n,o){e.CheckParam.getInstance().check(["object","object"],"sendLocalMessage"),t._dataAccessProvider.updateMessage(n),this.sendMessage(n.conversationType,n.targetId,n.content,o)},t.prototype.sendMessage=function(n,o,s,r){if(e.CheckParam.getInstance().check(["number","string","object","object"],"sendMessage"),!e.Bridge._client.channel)return void r.onError(e.ErrorCode.RC_NET_UNAVAILABLE,null);if(!e.Bridge._client.channel.socket.socket.connected)throw r.onError(e.ErrorCode.TIMEOUT,null),new Error("connect is timeout! postion:sendMessage");var i=new Modules.UpStreamMessage;i.setSessionId(t.MessageParams[s.messageName].msgTag.getMessageTag()),i.setClassname(t.MessageParams[s.messageName].objectName),i.setContent(s.encode());var a=i.toArrayBuffer();"[object ArrayBuffer]"==Object.prototype.toString.call(a)&&(a=[].slice.call(new Int8Array(a)));var c=null,u=this,g=new e.Message;this.getConversation(n,o,{onSuccess:function(s){c=s,3==t.MessageParams[g.messageType].msgTag.getMessageTag()&&(c||(c=u.createConversation(n,o,"")),c.sentTime=(new Date).getTime(),c.sentStatus=e.SentStatus.SENDING,c.senderUserName="",c.senderUserId=e.Bridge._client.userId,c.notificationStatus=e.ConversationNotificationStatus.DO_NOT_DISTURB,c.latestMessage=g,c.unreadMessageCount=0,t._dataAccessProvider.addConversation(c,{onSuccess:function(e){}})),t._memoryStore.converStore=c}}),g.content=s,g.conversationType=n,g.senderUserId=e.Bridge._client.userId,g.objectName=t.MessageParams[s.messageName].objectName,g.targetId=o,g.sentTime=(new Date).getTime(),g.messageDirection=e.MessageDirection.SEND,g.sentStatus=e.SentStatus.SENT,g.messageType=s.messageName,t.bridge.pubMsg(n.valueOf(),a,o,{onSuccess:function(s){3==t.MessageParams[g.messageType].msgTag.getMessageTag()&&(t._memoryStore.converStore.latestMessage=g,
t._dataAccessProvider.addMessage(n,o,g,{onSuccess:function(n){g=n,g.messageUId=s.messageUId,g.sentTime=s.timestamp,g.sentStatus=e.SentStatus.SENT,t._dataAccessProvider.updateMessage(g)},onError:function(){}})),setTimeout(function(){r.onSuccess(g)})},onError:function(s){g.sentStatus=e.SentStatus.FAILED,t._memoryStore.converStore.latestMessage=g,t._dataAccessProvider.addMessage(n,o,g,{onSuccess:function(e){g.messageId=e.messageId,t._dataAccessProvider.updateMessage(g)},onError:function(){}}),setTimeout(function(){r.onError(s,g)})}},null)},t.prototype.sendTypingStatusMessage=function(n,o,s,r){var i=this;s in t.MessageParams&&i.sendMessage(n,o,e.TypingStatusMessage.obtain(t.MessageParams[s].objectName,""),{onSuccess:function(){setTimeout(function(){r.onSuccess()})},onError:function(e){setTimeout(function(){r.onError(e,null)})}})},t.prototype.sendStatusMessage=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.sendTextMessage=function(t,n,o,s){var r=e.TextMessage.obtain(o);this.sendMessage(t,n,r,s)},t.prototype.insertMessage=function(n,o,s,r,i){var a=new e.Message;a.conversationType=n,a.targetId=o,a.senderUserId=s,a.content=r,a.sentTime=+new Date,a.messageType=r.messageName,t._dataAccessProvider.addMessage(n,o,a,i)},t.prototype.getHistoryMessages=function(n,o,s,r,i){if(e.CheckParam.getInstance().check(["number","string","number|null|global|object","number","object"],"getHistoryMessages"),r>20)throw new Error("HistroyMessage count must be less than or equal to 20!");if(n.valueOf()<0)throw new Error("ConversationType must be greater than -1");t._dataAccessProvider.getHistoryMessages(n,o,s,r,i)},t.prototype.getRemoteHistoryMessages=function(n,o,s,r,i){if(e.CheckParam.getInstance().check(["number","string","number|null|global|object","number","object"],"getRemoteHistoryMessages"),r>20)return void i.onError(e.ErrorCode.RC_CONN_PROTO_VERSION_ERROR);if(n.valueOf()<0)return void i.onError(e.ErrorCode.RC_CONN_PROTO_VERSION_ERROR);var a=new Modules.HistoryMessageInput;a.setTargetId(o),0===s?a.setDataTime(s):a.setDataTime(t._memoryStore.lastReadTime.get(n+o)),a.setSize(r),t.bridge.queryMsg(HistoryMsgType[n],e.MessageUtil.ArrayForm(a.toArrayBuffer()),o,{onSuccess:function(s){t._memoryStore.lastReadTime.set(n+o,e.MessageUtil.int64ToTimestamp(s.syncTime));for(var r=s.list.reverse(),a=0,c=r.length;c>a;a++)r[a]=e.MessageUtil.messageParser(r[a]);setTimeout(function(){i.onSuccess(r,!!s.hasMsg)})},onError:function(t){setTimeout(function(){t===e.ErrorCode.TIMEOUT?i.onError(t):i.onSuccess([],!1)})}},"HistoryMessagesOuput")},t.prototype.hasRemoteUnreadMessages=function(n,o){var s=null;window.RCCallback=function(e){setTimeout(function(){o.onSuccess(!!+e.status)}),s.parentNode.removeChild(s)},s=document.createElement("script"),s.src=e.MessageUtil.schemeArrs[t.schemeType][0]+"://api.cn.ronghub.com/message/exist.js?appKey="+encodeURIComponent(t._memoryStore.appKey)+"&token="+encodeURIComponent(n)+"&callBack=RCCallback&_="+Date.now(),document.body.appendChild(s),s.onerror=function(){setTimeout(function(){o.onError(e.ErrorCode.UNKNOWN)}),s.parentNode.removeChild(s)}},t.prototype.getTotalUnreadCount=function(e){t._dataAccessProvider.getTotalUnreadCount({onSuccess:function(t){setTimeout(function(){e.onSuccess(t)})},onError:function(t){setTimeout(function(){e.onError(t)})}})},t.prototype.getConversationUnreadCount=function(e,n){t._dataAccessProvider.getConversationUnreadCount(e,{onSuccess:function(e){setTimeout(function(){n.onSuccess(e)})},onError:function(e){setTimeout(function(){n.onError(e)})}})},t.prototype.getUnreadCount=function(e,n,o){t._dataAccessProvider.getUnreadCount(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.clearUnreadCount=function(e,n,o){t._dataAccessProvider.clearUnreadCount(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.setMessageExtra=function(e,n,o){t._dataAccessProvider.setMessageExtra(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.setMessageReceivedStatus=function(e,n,o){t._dataAccessProvider.setMessageReceivedStatus(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.setMessageSentStatus=function(e,n,o){t._dataAccessProvider.setMessageSentStatus(e,n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}})},t.prototype.clearTextMessageDraft=function(n,o){e.CheckParam.getInstance().check(["number","string","object"],"clearTextMessageDraft");var s="darf_"+n+"_"+o;return delete t._memoryStore[s],!0},t.prototype.getTextMessageDraft=function(n,o){if(e.CheckParam.getInstance().check(["number","string","object"],"getTextMessageDraft"),""==o||0>n)throw new Error("params error : "+e.ErrorCode.DRAF_GET_ERROR);var s="darf_"+n+"_"+o;return t._memoryStore[s]},t.prototype.saveTextMessageDraft=function(n,o,s){e.CheckParam.getInstance().check(["number","string","string","object"],"saveTextMessageDraft");var r="darf_"+n+"_"+o;return t._memoryStore[r]=s,!0},t.prototype.clearConversations=function(n){for(var o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];0==o.length&&(o=[e.ConversationType.CHATROOM,e.ConversationType.CUSTOMER_SERVICE,e.ConversationType.DISCUSSION,e.ConversationType.GROUP,e.ConversationType.PRIVATE,e.ConversationType.SYSTEM,e.ConversationType.PUBLIC_SERVICE,e.ConversationType.APP_PUBLIC_SERVICE]),t._dataAccessProvider.clearConversations(o,{onSuccess:function(e){setTimeout(function(){n.onSuccess(e)})},onError:function(e){setTimeout(function(){n.onError(e)})}})},t.prototype.getConversation=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"getConversation"),t._dataAccessProvider.getConversation(n,o,{onSuccess:function(e){setTimeout(function(){s.onSuccess(e)})},onError:function(e){setTimeout(function(){s.onError(e)})}})},t.prototype.pottingConversation=function(n){var o=this,s=!1;t._dataAccessProvider.getConversation(n.type,n.userId,{onSuccess:function(r){if(r?s=!0:r=new e.Conversation,r.conversationType=n.type,r.targetId=n.userId,r.latestMessage=e.MessageUtil.messageParser(n.msg),r.latestMessageId=r.latestMessage.messageId,r.objectName=r.latestMessage.objectName,r.receivedStatus=r.latestMessage.receivedStatus,r.receivedTime=r.latestMessage.receiveTime,r.sentStatus=r.latestMessage.sentStatus,r.sentTime=r.latestMessage.sentTime,!s)if(e.MessageUtil.supportLargeStorage()){var i=e.LocalStorageProvider.getInstance().getItem("cu"+e.Bridge._client.userId+n.type+n.userId);r.unreadMessageCount=Number(i)}else r.unreadMessageCount=0;r.conversationType==e.ConversationType.DISCUSSION&&o.getDiscussion(n.userId,{onSuccess:function(e){r.conversationTitle=e.name},onError:function(e){}}),t._dataAccessProvider.addConversation(r,{onSuccess:function(e){}})},onError:function(e){}})},t.prototype.sortConversationList=function(e){for(var n=[],o=0,s=e.length;s>o;o++)if(e[o].isTop)n.push(e[o]),e.splice(o,1);else for(var r=0;s-o-1>r;r++)if(e[r].sentTime<e[r+1].sentTime){var i=e[r];e[r]=e[r+1],e[r+1]=i}t._memoryStore.conversationList=n.concat(e)},t.prototype.getConversationList=function(n,o){e.CheckParam.getInstance().check(["object","null|array|object|global"],"getConversationList");var s=this;t._dataAccessProvider.getConversationList({onSuccess:function(e){o?setTimeout(function(){n.onSuccess(e)}):(t._memoryStore.isUseWebSQLProvide&&s.sortConversationList(t._memoryStore.conversationList),setTimeout(function(){n.onSuccess(t._memoryStore.conversationList)}))},onError:function(t){t===e.ErrorCode.TIMEOUT?n.onError(t):n.onSuccess([])}},o)},t.prototype.getRemoteConversationList=function(n,o){e.CheckParam.getInstance().check(["object","null|array|object|global"],"getRemoteConversationList");var s=new Modules.RelationsInput,r=this;s.setType(1),t.bridge.queryMsg(26,e.MessageUtil.ArrayForm(s.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){if(e.info)for(var s=0,i=e.info.length;i>s;s++)r.pottingConversation(e.info[s]);if(o){var a=[];Array.forEach(o,function(e){Array.forEach(t._memoryStore.conversationList,function(t){t.conversationType==e&&a.push(t)})}),n.onSuccess(a)}else n.onSuccess(t._memoryStore.conversationList)},onError:function(t){t===e.ErrorCode.TIMEOUT?n.onError(t):n.onSuccess([])}},"RelationsOutput")},t.prototype.updateConversation=function(e){return t._dataAccessProvider.updateConversation(e)},t.prototype.createConversation=function(t,n,o){e.CheckParam.getInstance().check(["number","string","string"],"createConversation");var s=new e.Conversation;return s.targetId=n,s.conversationType=t,s.conversationTitle=o,s.latestMessage={},s.unreadMessageCount=0,s},t.prototype.removeConversation=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"removeConversation");var r=new Modules.RelationsInput;r.setType(n),t.bridge.queryMsg(27,e.MessageUtil.ArrayForm(r.toArrayBuffer()),o,{onSuccess:function(){t._dataAccessProvider.removeConversation(n,o,{onSuccess:function(){setTimeout(function(){s.onSuccess(!0)})},onError:function(){setTimeout(function(){s.onError(e.ErrorCode.CONVER_REMOVE_ERROR)})}})},onError:function(){setTimeout(function(){s.onError(e.ErrorCode.CONVER_REMOVE_ERROR)})}})},t.prototype.setConversationToTop=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"setConversationToTop"),t._dataAccessProvider.setConversationToTop(n,o,{onSuccess:function(e){setTimeout(function(){s.onSuccess(e)})},onError:function(e){setTimeout(function(){s.onError(e)})}})},t.prototype.getConversationNotificationStatus=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.setConversationNotificationStatus=function(e,t,n,o){throw new Error("Not implemented yet")},t.prototype.getNotificationQuietHours=function(e){throw new Error("Not implemented yet")},t.prototype.removeNotificationQuietHours=function(e){throw new Error("Not implemented yet")},t.prototype.setNotificationQuietHours=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.addMemberToDiscussion=function(n,o,s){e.CheckParam.getInstance().check(["string","array","object"],"addMemberToDiscussion");var r=new Modules.ChannelInvitationInput;r.setUsers(o),t.bridge.queryMsg(0,e.MessageUtil.ArrayForm(r.toArrayBuffer()),n,{onSuccess:function(){setTimeout(function(){s.onSuccess()})},onError:function(){setTimeout(function(){s.onError(e.ErrorCode.JOIN_IN_DISCUSSION)})}})},t.prototype.createDiscussion=function(n,o,s){e.CheckParam.getInstance().check(["string","array","object"],"createDiscussion");var r=new Modules.CreateDiscussionInput,i=this;r.setName(n),t.bridge.queryMsg(1,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){o.length>0&&i.addMemberToDiscussion(e,o,{onSuccess:function(){},onError:function(e){setTimeout(function(){s.onError(e)})}}),setTimeout(function(){s.onSuccess(e)})},onError:function(){setTimeout(function(){s.onError(e.ErrorCode.CREATE_DISCUSSION)})}},"CreateDiscussionOutput")},t.prototype.getDiscussion=function(n,o){e.CheckParam.getInstance().check(["string","object"],"getDiscussion");var s=new Modules.ChannelInfoInput;s.setNothing(1),t.bridge.queryMsg(4,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){setTimeout(function(){o.onError(e)})}},"ChannelInfoOutput")},t.prototype.quitDiscussion=function(n,o){e.CheckParam.getInstance().check(["string","object"],"quitDiscussion");var s=new Modules.LeaveChannelInput;s.setNothing(1),t.bridge.queryMsg(7,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,o)},t.prototype.removeMemberFromDiscussion=function(n,o,s){e.CheckParam.getInstance().check(["string","string","object"],"removeMemberFromDiscussion");var r=new Modules.ChannelEvictionInput;r.setUser(o),t.bridge.queryMsg(9,e.MessageUtil.ArrayForm(r.toArrayBuffer()),n,s)},t.prototype.setDiscussionInviteStatus=function(n,o,s){e.CheckParam.getInstance().check(["string","number","object"],"setDiscussionInviteStatus");var r=new Modules.ModifyPermissionInput;r.setOpenStatus(o.valueOf()),t.bridge.queryMsg(11,e.MessageUtil.ArrayForm(r.toArrayBuffer()),n,{onSuccess:function(e){setTimeout(function(){s.onSuccess()})},onError:function(){setTimeout(function(){s.onError(e.ErrorCode.INVITE_DICUSSION)})}})},t.prototype.setDiscussionName=function(n,o,s){e.CheckParam.getInstance().check(["string","string","object"],"setDiscussionName");var r=new Modules.RenameChannelInput;r.setName(o),t.bridge.queryMsg(12,e.MessageUtil.ArrayForm(r.toArrayBuffer()),n,{onSuccess:function(){setTimeout(function(){s.onSuccess()})},onError:function(e){s.onError(e)}})},t.prototype.joinGroup=function(n,o,s){e.CheckParam.getInstance().check(["string","string","object"],"joinGroup");var r=new Modules.GroupInfo;r.setId(n),r.setName(o);var i=new Modules.GroupInput;i.setGroupInfo([r]),t.bridge.queryMsg(6,e.MessageUtil.ArrayForm(i.toArrayBuffer()),n,{onSuccess:function(){setTimeout(function(){s.onSuccess()})},onError:function(e){s.onError(e)}},"GroupOutput")},t.prototype.quitGroup=function(n,o){e.CheckParam.getInstance().check(["string","object"],"quitGroup");var s=new Modules.LeaveChannelInput;s.setNothing(1),t.bridge.queryMsg(8,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(e){o.onError(e)}})},t.prototype.syncGroup=function(n,o){e.CheckParam.getInstance().check(["array","object"],"syncGroup");for(var s=0,r=[],i=[],a=n.length;a>s;s++)if(0===r.length||!(n[s].id in r)){r.push(n[s].id);var c=new Modules.GroupInfo;c.setId(n[s].id),c.setName(n[s].name),i.push(c)}var u=new Modules.GroupHashInput;u.setUserId(e.Bridge._client.userId),u.setGroupHashCode(md5(r.sort().join(""))),t.bridge.queryMsg(13,e.MessageUtil.ArrayForm(u.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(n){if(1===n){var s=new Modules.GroupInput;s.setGroupInfo(i),t.bridge.queryMsg(20,e.MessageUtil.ArrayForm(s.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.GROUP_MATCH_ERROR)})}},"GroupOutput")}else setTimeout(function(){o.onSuccess()})},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.GROUP_SYNC_ERROR)})}},"GroupHashOutput")},t.prototype.joinChatRoom=function(n,o,s){if(e.CheckParam.getInstance().check(["string","number","object"],"joinChatRoom"),""==n)return void setTimeout(function(){s.onError(e.ErrorCode.CHATROOM_ID_ISNULL)});var r=new Modules.ChrmInput;r.setNothing(1),e.Bridge._client.chatroomId=n,t.bridge.queryMsg(19,e.MessageUtil.ArrayForm(r.toArrayBuffer()),n,{onSuccess:function(){s.onSuccess();var r=new Modules.ChrmPullMsg;0==o&&(o=-1),r.setCount(o),r.setSyncTime(0),e.Bridge._client.queryMessage("chrmPull",e.MessageUtil.ArrayForm(r.toArrayBuffer()),n,1,{onSuccess:function(o){var s=e.MessageUtil.int64ToTimestamp(o.syncTime);t._cookieHelper.setItem(e.Bridge._client.userId+n+"CST",s);var r=o.list;if(t._memoryStore.filterMessages.length>0)for(var i=0,a=r.length;a>i;i++)for(var c=0,u=t._memoryStore.filterMessages.length;u>c;c++)t.MessageParams[t._memoryStore.filterMessages[c]].objectName!=r[i].classname&&e.Bridge._client.handler.onReceived(r[i]);else for(var i=0,g=r.length;g>i;i++)e.Bridge._client.handler.onReceived(r[i])},onError:function(t){setTimeout(function(){s.onError(e.ErrorCode.CHATROOM_HISMESSAGE_ERROR)})}},"DownStreamMessages")},onError:function(){setTimeout(function(){s.onError(e.ErrorCode.CHARTOOM_JOIN_ERROR)})}},"ChrmOutput")},t.prototype.getChatRoomInfo=function(n,o,s,r){e.CheckParam.getInstance().check(["string","number","number","object"],"getChatRoomInfo");var i=new Modules.QueryChatroomInfoInput;i.setCount(o),i.setOrder(s),t.bridge.queryMsg("queryChrmI",e.MessageUtil.ArrayForm(i.toArrayBuffer()),n,{onSuccess:function(e){setTimeout(function(){r.onSuccess(e)})},onError:function(e){r.onError(e)}},"QueryChatroomInfoOutput")},t.prototype.quitChatRoom=function(n,o){e.CheckParam.getInstance().check(["string","object"],"quitChatRoom");var s=new Modules.ChrmInput;s.setNothing(1),t.bridge.queryMsg(17,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,{onSuccess:function(){setTimeout(function(){o.onSuccess()})},onError:function(e){o.onError(e)}},"ChrmOutput")},t.prototype.getRemotePublicServiceList=function(n,o,s,r){var i=new Modules.PullMpInput;s?i.setTime(t._memoryStore.lastReadTime.get(o+e.Bridge._client.userId)):i.setTime(0),i.setMpid(""),t.bridge.queryMsg(28,e.MessageUtil.ArrayForm(i.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){t._memoryStore.publicServiceMap.publicServiceList.length=0,t._memoryStore.publicServiceMap.publicServiceList=e},onError:function(){}},"PullMpOutput")},t.prototype.getPublicServiceList=function(n){e.CheckParam.getInstance().check(["object"],"getPublicServiceList"),n.onSuccess(t._memoryStore.publicServiceMap.publicServiceList)},t.prototype.getPublicServiceProfile=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"getPublicServiceProfile");var r=t._memoryStore.publicServiceMap.get(n,o);s.onSuccess(r)},t.prototype.pottingPublicSearchType=function(e,t){var n=0;return 0==e?(n|=3,n|=0==t?12:48):1==e?(n|=1,n|=0==t?8:32):(n|=2,n|=0==e?4:16),n},t.prototype.searchPublicService=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"searchPublicService");var r=new Modules.SearchMpInput;r.setType(this.pottingPublicSearchType(0,n)),r.setId(o),t.bridge.queryMsg(29,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,s,"SearchMpOutput")},t.prototype.searchPublicServiceByType=function(n,o,s,r){e.CheckParam.getInstance().check(["number","number","string","object"],"searchPublicServiceByType");var i=n==e.ConversationType.APP_PUBLIC_SERVICE?2:1,a=new Modules.SearchMpInput;a.setType(this.pottingPublicSearchType(i,o)),a.setId(s),t.bridge.queryMsg(29,e.MessageUtil.ArrayForm(a.toArrayBuffer()),e.Bridge._client.userId,r,"SearchMpOutput")},t.prototype.subscribePublicService=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"subscribePublicService");var r=new Modules.MPFollowInput,i=this,a=n==e.ConversationType.APP_PUBLIC_SERVICE?"mcFollow":"mpFollow";r.setId(o),t.bridge.queryMsg(a,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(){i.getRemotePublicServiceList(null,null,null,{onSuccess:function(){},onError:function(){}}),s.onSuccess()},onError:function(){s.onError(e.ErrorCode.SUBSCRIBE_ERROR)}},"MPFollowOutput")},t.prototype.unsubscribePublicService=function(n,o,s){e.CheckParam.getInstance().check(["number","string","object"],"unsubscribePublicService");var r=new Modules.MPFollowInput,i=n==e.ConversationType.APP_PUBLIC_SERVICE?"mcUnFollow":"mpUnFollow";r.setId(o),t.bridge.queryMsg(i,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(){t._memoryStore.publicServiceMap.remove(n,o),s.onSuccess()},onError:function(){s.onError(e.ErrorCode.SUBSCRIBE_ERROR)}},"MPFollowOutput")},t.prototype.addToBlacklist=function(n,o){e.CheckParam.getInstance().check(["string","object"],"addToBlacklist");var s=new Modules.Add2BlackListInput;s.setUserId(n),t.bridge.queryMsg(21,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,{onSuccess:function(){o.onSuccess()},onError:function(){o.onError(e.ErrorCode.BLACK_ADD_ERROR)}})},t.prototype.getBlacklist=function(n){e.CheckParam.getInstance().check(["object"],"getBlacklist");var o=new Modules.QueryBlackListInput;o.setNothing(1),t.bridge.queryMsg(23,e.MessageUtil.ArrayForm(o.toArrayBuffer()),e.Bridge._client.userId,n,"QueryBlackListOutput")},t.prototype.getBlacklistStatus=function(n,o){e.CheckParam.getInstance().check(["string","object"],"getBlacklistStatus");var s=new Modules.BlackListStatusInput;s.setUserId(n),t.bridge.queryMsg(24,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,{onSuccess:function(t){setTimeout(function(){o.onSuccess(e.BlacklistStatus[t])})},onError:function(){setTimeout(function(){o.onError(e.ErrorCode.BLACK_GETSTATUS_ERROR)})}})},t.prototype.removeFromBlacklist=function(n,o){e.CheckParam.getInstance().check(["string","object"],"removeFromBlacklist");var s=new Modules.RemoveFromBlackListInput;s.setUserId(n),t.bridge.queryMsg(22,e.MessageUtil.ArrayForm(s.toArrayBuffer()),n,{onSuccess:function(){o.onSuccess()},onError:function(){o.onError(e.ErrorCode.BLACK_REMOVE_ERROR)}})},t.prototype.getFileToken=function(n,o){if(e.CheckParam.getInstance().check(["number","object"],"getQnTkn"),!/(1|2|3)/.test(n.toString()))return void o.onError(e.ErrorCode.QNTKN_FILETYPE_ERROR);var s=new Modules.GetQNupTokenInput;s.setType(n),t.bridge.queryMsg(30,e.MessageUtil.ArrayForm(s.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){setTimeout(function(){o.onSuccess(e)})},onError:function(e){o.onError(e)}},"GetQNupTokenOutput")},t.prototype.getFileUrl=function(n,o,s){if(e.CheckParam.getInstance().check(["number","string","object"],"getQnTkn"),!/(1|2|3)/.test(n.toString()))return void setTimeout(function(){s.onError(e.ErrorCode.QNTKN_FILETYPE_ERROR)});var r=new Modules.GetQNdownloadUrlInput;r.setType(n),r.setKey(o),t.bridge.queryMsg(31,e.MessageUtil.ArrayForm(r.toArrayBuffer()),e.Bridge._client.userId,{onSuccess:function(e){setTimeout(function(){s.onSuccess(e)})},onError:function(e){s.onError(e)}},"GetQNdownloadUrlOutput")},t.prototype.addRealTimeLocationListener=function(e,t,n){throw new Error("Not implemented yet")},t.prototype.getRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.getRealTimeLocationCurrentState=function(e,t){throw new Error("Not implemented yet")},t.prototype.getRealTimeLocationParticipants=function(e,t){throw new Error("Not implemented yet")},t.prototype.joinRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.quitRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.startRealTimeLocation=function(e,t){throw new Error("Not implemented yet")},t.prototype.updateRealTimeLocationStatus=function(e,t,n,o){throw new Error("Not implemented yet")},t.MessageType={},t.RegisterMessage={},t._memoryStore={},t.isNotPullMsg=!1,t}();if(e.RongIMClient=t,"function"==typeof require&&"object"==typeof module&&module&&module.id&&"object"==typeof exports&&exports)module.exports=e;else if("function"==typeof define&&define.amd)if(window.WEB_XHR_POLLING)define("RongIMLib",["md5"],function(){return e});else{var n=window.SCHEMETYPE?window.SCHEMETYPE+"://cdn.ronghub.com/Long.js":"//cdn.ronghub.com/Long.js",o=window.SCHEMETYPE?window.SCHEMETYPE+"://cdn.ronghub.com/byteBuffer.js":"//cdn.ronghub.com/byteBuffer.js",s=window.SCHEMETYPE?window.SCHEMETYPE+"://cdn.ronghub.com/protobuf-2.1.1.min.js":"//cdn.ronghub.com/protobuf-2.1.1.min.js";define("RongIMLib",["md5",n,o,s],function(){return e})}else window.RongIMClient=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){!function(e){e[e.AT_MOST_ONCE=0]="AT_MOST_ONCE",e[e.AT_LEAST_ONCE=1]="AT_LEAST_ONCE",e[e.EXACTLY_ONCE=2]="EXACTLY_ONCE",e[e.DEFAULT=3]="DEFAULT"}(e.Qos||(e.Qos={}));var t=e.Qos;!function(e){e[e.CONNECT=1]="CONNECT",e[e.CONNACK=2]="CONNACK",e[e.PUBLISH=3]="PUBLISH",e[e.PUBACK=4]="PUBACK",e[e.QUERY=5]="QUERY",e[e.QUERYACK=6]="QUERYACK",e[e.QUERYCON=7]="QUERYCON",e[e.SUBSCRIBE=8]="SUBSCRIBE",e[e.SUBACK=9]="SUBACK",e[e.UNSUBSCRIBE=10]="UNSUBSCRIBE",e[e.UNSUBACK=11]="UNSUBACK",e[e.PINGREQ=12]="PINGREQ",e[e.PINGRESP=13]="PINGRESP",e[e.DISCONNECT=14]="DISCONNECT"}(e.Type||(e.Type={}));var n=(e.Type,["invtDiz","crDiz","qnUrl","userInf","dizInf","userInf","joinGrp","quitDiz","exitGrp","evctDiz",["","ppMsgP","pdMsgP","pgMsgP","chatMsg","pcMsgP","","pmcMsgN","pmpMsgN"],"pdOpen","rename","uGcmpr","qnTkn","destroyChrm","createChrm","exitChrm","queryChrm","joinChrm","pGrps","addBlack","rmBlack","getBlack","blackStat","addRelation","qryRelation","delRelation","pullMp","schMp","qnTkn","qnUrl"]),o=function(){function t(n,o,r){if(this.connectionStatus=-1,this.delOnChangedCount=0,this.url=n.host+"/websocket?appId="+r.appId+"&token="+encodeURIComponent(r.token)+"&sdkVer="+r.sdkVer+"&apiVer="+r.apiVer,this.self=r,this.socket=s.getInstance().createServer(),this.socket.connect(this.url,o),!("object"==typeof t._ConnectionStatusListener&&"onChanged"in t._ConnectionStatusListener))throw new Error("setConnectStatusListener:Parameter format is incorrect");var i=this;i.socket.on("StatusChanged",function(n){return i.connectionStatus=n,n===e.ConnectionStatus.NETWORK_UNAVAILABLE&&e.RongIMClient._cookieHelper.setItem("rongSDK",""),n!==e.ConnectionStatus.DISCONNECTED||e.RongIMClient._memoryStore.otherDevice?void(n===e.ConnectionStatus.DISCONNECTED&&e.RongIMClient._memoryStore.otherDevice||(t._ConnectionStatusListener.onChanged(n),e.RongIMClient._memoryStore.otherDevice&&(i.delOnChangedCount>5&&delete t._ConnectionStatusListener.onChanged,i.delOnChangedCount++))):(t._ConnectionStatusListener.onChanged(e.ConnectionStatus.DISCONNECTED),void r.clearHeartbeat())}),this.socket.on("message",r.handler.handleMessage),this.socket.on("disconnect",function(e){r.channel.socket.fire("StatusChanged",e?e:2)})}return t.prototype.writeAndFlush=function(e){this.socket.send(e)},t.prototype.reconnect=function(t){e.MessageIdHandler.clearMessageId(),this.socket=this.socket.reconnect(),t&&(this.self.reconnectObj=t)},t.prototype.disconnect=function(e){this.socket.disconnect(e)},t}();e.Channel=o;var s=function(){function t(){this.socket=null,this._events={}}return t.getInstance=function(){return new t},t.prototype.connect=function(t,n){return this.socket&&(t&&(e.RongIMClient._cookieHelper.setItem("rongSDK",this.checkTransport()),this.on("connect",n||new Function)),t&&(this.currentURL=t),this.socket.createTransport(t)),this},t.prototype.createServer=function(){var e=this.getTransport(this.checkTransport());if(null===e)throw new Error("the channel was not supported");return e},t.prototype.getTransport=function(n){return n==t.XHR_POLLING?this.socket=new e.PollingTransportation(this):n==t.WEBSOCKET&&(this.socket=new e.SocketTransportation(this)),this},t.prototype.send=function(e){this.socket&&(this.checkTransport()==t.WEBSOCKET?this.socket.send(e):this.socket.send(this._encode(e)))},t.prototype.onMessage=function(e){this.fire("message",e)},t.prototype.disconnect=function(t){return e.ConnectionStatus.KICKED_OFFLINE_BY_OTHER_CLIENT===t&&(e.RongIMClient._memoryStore.otherDevice=!0),this.socket.disconnect(t),this.fire("disconnect",t),this},t.prototype.reconnect=function(){if(this.currentURL)return this.connect(this.currentURL,null);throw new Error("reconnect:no have URL")},t.prototype.checkTransport=function(){return e.RongIMClient._memoryStore.global.WEB_XHR_POLLING&&(e.Transportations._TransportType=t.XHR_POLLING),e.Transportations._TransportType},t.prototype.fire=function(e,t){if(e in this._events)for(var n=0,o=this._events[e].length;o>n;n++)this._events[e][n](t);return this},t.prototype.on=function(t,n){return"function"==typeof n&&t?(t in this._events?-1==e.MessageUtil.indexOf(this._events,n)&&this._events[t].push(n):this._events[t]=[n],this):this},t.prototype.removeEvent=function(e,t){if(e in this._events)for(var n=0,o=this._events[e].length;o>n;n++)this._events[e][n]==t&&this._events[e].splice(n,1);return this},t.prototype._encode=function(t){var n="?messageid="+t.getMessageId()+"&header="+t.getHeaderFlag()+"&sessionid="+e.RongIMClient._cookieHelper.getItem(e.Navigation.Endpoint.userId+"sId");return/(PubAckMessage|QueryConMessage)/.test(t._name)||(n+="&topic="+t.getTopic()+"&targetid="+(t.getTargetId()||"")),{url:n,data:"getData"in t?t.getData():""}},t.XHR_POLLING="xhr-polling",t.WEBSOCKET="websocket",t}();e.Socket=s;var r=function(){function n(e,t){this.timeoutMillis=1e5,this.timeout_=0,this.sdkVer="2.1.1",this.apiVer=Math.floor(1e6*Math.random()),this.channel=null,this.handler=null,this.userId="",this.reconnectObj={},this.heartbeat=0,this.chatroomId="",this.SyncTimeQueue=[],this.cacheMessageIds=[],this.token=e,this.appId=t,this.SyncTimeQueue.state="complete"}return n.prototype.resumeTimer=function(){this.timeout_||(this.timeout_=setTimeout(function(){if(this.timeout_){try{this.channel.disconnect()}catch(e){throw new Error(e)}clearTimeout(this.timeout_),this.timeout_=0,this.channel.reconnect(),this.channel.socket.fire("StatusChanged",5)}},this.timeoutMillis))},n.prototype.pauseTimer=function(){this.timeout_&&(clearTimeout(this.timeout_),this.timeout_=0)},n.prototype.connect=function(t){if(e.Navigation.Endpoint.host){if(e.Transportations._TransportType==s.WEBSOCKET&&!window.WebSocket)return void t.onError(e.ConnectionState.UNACCEPTABLE_PROTOCOL_VERSION);this.handler=new a(this),this.handler.setConnectCallback(t);var n=this;this.channel=new o(e.Navigation.Endpoint,function(){e.Transportations._TransportType==s.WEBSOCKET&&n.keepLive()},this),this.channel.socket.fire("StatusChanged",1)}else t.onError(e.ConnectionState.NOT_AUTHORIZED)},n.prototype.keepLive=function(){this.heartbeat>0&&clearInterval(this.heartbeat);var t=this;this.heartbeat=setInterval(function(){t.resumeTimer(),t.channel.writeAndFlush(new e.PingReqMessage)},3e4)},n.prototype.clearHeartbeat=function(){clearInterval(this.heartbeat),this.heartbeat=0,this.pauseTimer()},n.prototype.publishMessage=function(n,o,s,r,i){var a=e.MessageIdHandler.messageIdPlus(this.channel.reconnect);if(a){var c=new e.PublishMessage(n,o,s);c.setMessageId(a),r?(c.setQos(t.AT_LEAST_ONCE),this.handler.putCallback(new e.PublishCallback(r.onSuccess,r.onError),c.getMessageId(),i)):c.setQos(t.AT_MOST_ONCE),this.channel.writeAndFlush(c)}},n.prototype.queryMessage=function(t,o,s,r,i,a){if("userInf"==t&&n.userInfoMapping[s])return void i.onSuccess(n.userInfoMapping[s]);var c=e.MessageIdHandler.messageIdPlus(this.channel.reconnect);if(c){var u=new e.QueryMessage(t,o,s);u.setMessageId(c),u.setQos(r),this.handler.putCallback(new e.QueryCallback(i.onSuccess,i.onError),u.getMessageId(),a),this.channel.writeAndFlush(u)}},n.prototype.invoke=function(n,o){var s,r,a,c,u=this,g=this.SyncTimeQueue.shift();if(void 0!=g){if(this.SyncTimeQueue.state="pending",2!=g.type)s=e.RongIMClient._cookieHelper.getItem(this.userId)||"0",r=new Modules.SyncRequestMsg,r.setIspolling(!1),a="pullMsg",c=this.userId;else if(c=o||u.chatroomId,s=e.RongIMClient._cookieHelper.getItem(i._client.userId+c+"CST")||"0",r=new Modules.ChrmPullMsg,r.setCount(0),a="chrmPull",!c)throw new Error("syncTime:Received messages of chatroom but was not init");if(g.pulltime<=s)return this.SyncTimeQueue.state="complete",void this.invoke(n,c);n&&r.setIsPullSend(!0),r.setSyncTime(s),this.queryMessage(a,e.MessageUtil.ArrayForm(r.toArrayBuffer()),c,t.AT_LEAST_ONCE,{onSuccess:function(t){var o=e.MessageUtil.int64ToTimestamp(t.syncTime),s=i._client.userId+""+c;"chrmPull"==a&&(s+="CST"),e.RongIMClient._memoryStore.isSyncRemoteConverList=!0,e.RongIMClient._cookieHelper.setItem(s,o),u.SyncTimeQueue.state="complete",u.invoke(n,c);for(var r=t.list,g=0,p=r.length;p>g;g++)if(!(r[g].msgId in u.cacheMessageIds)){i._client.handler.onReceived(r[g]);var h=u.cacheMessageIds.unshift(r[g].msgId);h>20&&(u.cacheMessageIds.length=20)}},onError:function(){u.SyncTimeQueue.state="complete",u.invoke(n,c)}},"DownStreamMessages")}},n.prototype.syncTime=function(e,t,n){this.SyncTimeQueue.push({type:e,pulltime:t}),1==this.SyncTimeQueue.length&&"complete"==this.SyncTimeQueue.state&&this.invoke(!e,n)},n.prototype.__init=function(t){this.channel=new o(e.Navigation.Endpoint,t,this)},n.userInfoMapping={},n}();e.Client=r;var i=function(){function s(){}return s.getInstance=function(){return new s},s.prototype.connect=function(t,n,o){return window.Modules?(s._client=(new e.Navigation).connect(t,n,o),s._client):void(e.RongIMClient._memoryStore.hasModules=!1)},s.prototype.setListener=function(e){"object"==typeof e&&("function"==typeof e.onChanged?o._ConnectionStatusListener=e:"function"==typeof e.onReceived&&(o._ReceiveMessageListener=e));
},s.prototype.reconnect=function(e){s._client.channel.reconnect(e)},s.prototype.disconnect=function(){s._client.clearHeartbeat(),s._client.channel.disconnect(2)},s.prototype.queryMsg=function(e,o,r,i,a){"string"!=typeof e&&(e=n[e]),s._client.queryMessage(e,o,r,t.AT_MOST_ONCE,i,a)},s.prototype.pubMsg=function(e,t,o,r,i){s._client.publishMessage(n[10][e],t,o,r,i)},s}();e.Bridge=i;var a=function(){function t(e){if(this.map={},this.connectCallback=null,!o._ReceiveMessageListener)throw new Error("please set onReceiveMessageListener");this._onReceived=o._ReceiveMessageListener.onReceived,this._client=e,this.syncMsgMap=new Object}return t.prototype.putCallback=function(e,t,n){var o={Callback:e,Message:n};o.Callback.resumeTimer(),this.map[t]=o},t.prototype.setConnectCallback=function(t){t&&(this.connectCallback=new e.ConnectAck(t.onSuccess,t.onError,this._client),this.connectCallback.resumeTimer())},t.prototype.onReceived=function(t,n){var o,s;if("PublishMessage"!=t._name)o=t,e.RongIMClient._cookieHelper.setItem(this._client.userId,e.MessageUtil.int64ToTimestamp(o.dataTime));else{if("s_ntf"==t.getTopic())return o=Modules.NotifyMsg.decode(t.getData()),void this._client.syncTime(o.type,e.MessageUtil.int64ToTimestamp(o.time),o.chrmId);if("s_msg"==t.getTopic())o=Modules.DownStreamMessage.decode(t.getData()),e.RongIMClient._cookieHelper.setItem(this._client.userId,e.MessageUtil.int64ToTimestamp(o.dataTime));else{if(i._client.sdkVer&&"1.0.0"==i._client.sdkVer)return;o=Modules.UpStreamMessage.decode(t.getData());var r=t.getTopic(),a=r.substr(0,2);"pp"==a?o.type=1:"pd"==a?o.type=2:"pg"==a?o.type=3:"ch"==a?o.type=4:"pc"==a&&(o.type=5),o.groupId=t.getTargetId(),o.fromUserId=this._client.userId,o.dataTime=Date.parse((new Date).toString())}if(!o)return}if(s=e.MessageUtil.messageParser(o,this._onReceived),n&&(s.messageUId=n.getMessageUId(),s.sentTime=n.getTimestamp()),null!==s){if(3==e.RongIMClient.MessageParams[s.messageType].msgTag.getMessageTag()&&e.RongIMClient._dataAccessProvider.getConversation(s.conversationType,s.targetId,{onSuccess:function(t){if(t||(t=e.RongIMClient.getInstance().createConversation(s.conversationType,s.targetId,"")),0!=t.conversationType&&s.senderUserId!=i._client.userId&&s.receivedStatus!=e.ReceivedStatus.RETRIEVED&&(t.unreadMessageCount=t.unreadMessageCount+1,e.MessageUtil.supportLargeStorage())){var n=e.LocalStorageProvider.getInstance().getItem("cu"+i._client.userId+t.conversationType+t.targetId);e.LocalStorageProvider.getInstance().setItem("cu"+i._client.userId+t.conversationType+s.targetId,Number(n)+1)}t.receivedTime=(new Date).getTime(),t.receivedStatus=e.ReceivedStatus.READ,t.senderUserId=s.sendUserId,t.notificationStatus=e.ConversationNotificationStatus.DO_NOT_DISTURB,t.latestMessageId=s.messageId,t.latestMessage=s,t.sentTime=s.sentTime,e.RongIMClient._dataAccessProvider.addConversation(t,{onSuccess:function(e){},onError:function(){}})},onError:function(e){}}),s.messageType===e.RongIMClient.MessageType.HandShakeResponseMessage){var c=s.content.data;e.RongIMClient._memoryStore.custStore[s.targetId]=c,c.serviceType!=e.CustomerType.ONLY_HUMAN&&c.serviceType!=e.CustomerType.HUMAN_FIRST||"1"==c.notAutoCha&&e.RongIMClient.getInstance().switchToHumanMode(s.targetId,{onSuccess:function(){},onError:function(){}})}if("TerminateMessage"!=s.messageType||e.RongIMClient._memoryStore.custStore[s.targetId].sid==s.content.sid){var u=this;e.RongIMClient._dataAccessProvider.addMessage(s.conversationType,s.targetId,s,{onSuccess:function(e){u._onReceived(e)},onError:function(e){u._onReceived(s)}})}}},t.prototype.handleMessage=function(t){if(t)switch(t._name){case"ConnAckMessage":i._client.handler.connectCallback.process(t.getStatus(),t.getUserId(),t.getTimestamp());break;case"PublishMessage":t.getSyncMsg()||0==t.getQos()||i._client.channel.writeAndFlush(new e.PubAckMessage(t.getMessageId())),t.getSyncMsg()&&!e.RongIMClient._memoryStore.global.WEB_XHR_POLLING?i._client.handler.syncMsgMap[t.getMessageId()]=t:i._client.handler.onReceived(t);break;case"QueryAckMessage":0!=t.getQos()&&i._client.channel.writeAndFlush(new e.QueryConMessage(t.getMessageId()));var n=i._client.handler.map[t.getMessageId()];n&&(n.Callback.process(t.getStatus(),t.getData(),t.getDate(),n.Message),delete i._client.handler.map[t.getMessageId()]);break;case"PubAckMessage":var o=i._client.handler.map[t.getMessageId()];o?(o.Callback.process(t.getStatus()||0,t.getMessageUId(),t.getTimestamp(),o.Message),delete i._client.handler.map[t.getMessageId()]):(i._client.handler.onReceived(i._client.handler.syncMsgMap[t.messageId],t),delete i._client.handler.syncMsgMap[t.getMessageId()]);break;case"PingRespMessage":i._client.pauseTimer();break;case"DisconnectMessage":i._client.channel.disconnect(t.getStatus())}},t}();e.MessageHandler=a}(RongIMLib||(RongIMLib={}));var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},RongIMLib;!function(e){var t=function(){function t(e){this.timeout=null,this.onError=null,e&&"number"==typeof e?this.timeoutMillis=e:(this.timeoutMillis=3e4,this.onError=e)}return t.prototype.resumeTimer=function(){var e=this;this.timeoutMillis>0&&!this.timeout&&(this.timeout=setTimeout(function(){e.readTimeOut(!0)},this.timeoutMillis))},t.prototype.pauseTimer=function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},t.prototype.readTimeOut=function(t){t&&this.onError?this.onError(e.ErrorCode.TIMEOUT):this.pauseTimer()},t}();e.MessageCallback=t;var n=function(){function t(){this.publicServiceList=[]}return t.getInstance=function(){return new t},t.prototype.pottingProfile=function(t){var n;this.profile=new e.PublicServiceProfile,n=JSON.parse(t.extra),this.profile.isGlobal=n.isGlobal,this.profile.introduction=n.introduction,this.profile.menu=n.menu,this.profile.hasFollowed=n.follow,this.profile.publicServiceId=t.mpid,this.profile.name=t.name,this.profile.portraitUri=t.portraitUrl,this.profile.conversationType="mc"==t.type?e.ConversationType.APP_PUBLIC_SERVICE:e.ConversationType.PUBLIC_SERVICE,this.publicServiceList.push(this.profile)},t.prototype.mapping=function(t,n){switch(n){case"GetUserInfoOutput":var o=new e.UserInfo(t.userId,t.userName,t.userPortrait);return o;case"GetQNupTokenOutput":return{deadline:e.MessageUtil.int64ToTimestamp(t.deadline),token:t.token};case"GetQNdownloadUrlOutput":return{downloadUrl:t.downloadUrl};case"CreateDiscussionOutput":return t.id;case"ChannelInfoOutput":var s=new e.Discussion;return s.creatorId=t.adminUserId,s.id=t.channelId,s.memberIdList=t.firstTenUserIds,s.name=t.channelName,s.isOpen=t.openStatus,s;case"GroupHashOutput":return t.result;case"QueryBlackListOutput":return t.userIds;case"SearchMpOutput":case"PullMpOutput":if(t.info){var r=this;Array.forEach(t.info,function(e){setTimeout(r.pottingProfile(e),100)})}return this.publicServiceList;default:return t}},t}();e.CallbackMapping=n;var o=function(n){function o(e,t){n.call(this,t),this._cb=e,this._timeout=t}return __extends(o,n),o.prototype.process=function(t,n,o,s){this.readTimeOut(),0==t?(s&&(s.setSentStatus=t),e.RongIMClient._cookieHelper.setItem(e.Bridge._client.userId,o),this._cb({messageUId:n,timestamp:o})):this._timeout(t)},o.prototype.readTimeOut=function(e){t.prototype.readTimeOut.call(this,e)},o}(t);e.PublishCallback=o;var s=function(o){function s(e,t){o.call(this,t),this._cb=e,this._timeout=t}return __extends(s,o),s.prototype.process=function(t,o,s,r){if(this.readTimeOut(),r&&o&&0==t){try{o=n.getInstance().mapping(Modules[r].decode(o),r)}catch(i){return void this._timeout(e.ErrorCode.UNKNOWN)}"GetUserInfoOutput"==r&&(e.Client.userInfoMapping[o.userId]=o),this._cb(o)}else t>0?this._timeout(t):this._cb(t)},s.prototype.readTimeOut=function(e){t.prototype.readTimeOut.call(this,e)},s}(t);e.QueryCallback=s;var r=function(n){function o(e,t,o){n.call(this,t),this._client=o,this._cb=e,this._timeout=t}return __extends(o,n),o.prototype.process=function(t,n,o){if(this.readTimeOut(),0==t){var s=e.RongIMClient._cookieHelper.getItem(e.RongIMClient._cookieHelper.getItemKey("navi")),r=e.RongIMClient._cookieHelper.getItemKey("navi"),i=decodeURIComponent(s).split(",");if(i[1]||(s=encodeURIComponent(s)+n,e.RongIMClient._cookieHelper.setItem(r,s)),e.RongIMClient._memoryStore.isUseWebSQLProvider&&e.RongIMClient._dataAccessProvider.database.init(n),this._client.userId=n,e.RongIMClient.isNotPullMsg||this._client.syncTime(),this._client.reconnectObj.onSuccess)this._client.reconnectObj.onSuccess(n),delete this._client.reconnectObj.onSuccess;else{var a=this;setTimeout(function(){a._cb(n)},500)}e.Bridge._client.channel.socket.fire("StatusChanged",0),(new Date).getTime()-o?e.RongIMClient._memoryStore.deltaTime=(new Date).getTime()-o:e.RongIMClient._memoryStore.deltaTime=0}else if(6==t){var c={},a=this;(new e.Navigation).getServerEndpoint(this._client.token,this._client.appId,function(){a._client.clearHeartbeat(),new e.Client(a._client.token,a._client.appId).__init.call(c,function(){"websocket"==e.Transportations._TransportType&&a._client.keepLive()}),a._client.channel.socket.fire("StatusChanged",2)},a._timeout,!1)}else e.Bridge._client.channel.socket.socket._status=t,this._client.reconnectObj.onError?(this._client.reconnectObj.onError(t),delete this._client.reconnectObj.onError):this._timeout(t)},o.prototype.readTimeOut=function(e){t.prototype.readTimeOut.call(this,e)},o}(t);e.ConnectAck=r}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(){window.getServerEndpoint=function(n){e.RongIMClient._cookieHelper._host=t.Endpoint.host=n.server,t.Endpoint.userId=n.userId;var o=e.RongIMClient._cookieHelper.getItemKey("navi");null!==o&&e.RongIMClient._cookieHelper.removeItem(o),e.RongIMClient._cookieHelper.setItem("navi"+md5(e.Bridge._client.token).slice(8,16),n.server+","+(n.userId||""))}}return t.prototype.connect=function(t,n,o){var s=e.RongIMClient._cookieHelper.getItem("appId");s&&s!=t&&(e.RongIMClient._cookieHelper.clearItem(),e.RongIMClient._cookieHelper.setItem("appId",t)),s||e.RongIMClient._cookieHelper.setItem("appId",t);var r=new e.Client(n,t);return this.getServerEndpoint(n,t,function(){r.connect(o)},o.onError,!0),r},t.prototype.getServerEndpoint=function(n,o,s,r,i){if(i){var a=md5(n).slice(8,16),c=e.RongIMClient._cookieHelper.getItem(e.RongIMClient._cookieHelper.getItemKey("navi")),u=e.RongIMClient._cookieHelper.getItem("navi"+a);if(c==u&&null!==u&&e.RongIMClient._cookieHelper.getItem("rongSDK")==e.Transportations._TransportType){var g=decodeURIComponent(c).split(",");return void setTimeout(function(){e.RongIMClient._cookieHelper._host=t.Endpoint.host=g[0],t.Endpoint.userId=g[1],s()},500)}}var p={"navUrl-Debug":e.MessageUtil.schemeArrs[e.RongIMClient.schemeType][0]+"://119.254.111.49:9100/","navUrl-Release":e.MessageUtil.schemeArrs[e.RongIMClient.schemeType][0]+"://nav.cn.ronghub.com/"},h=document.createElement("script");h.src=p["navUrl-Debug"]+(e.RongIMClient._memoryStore.global.WEB_XHR_POLLING?"cometnavi.js":"navi.js")+"?appId="+o+"&token="+encodeURIComponent(n)+"&callBack=getServerEndpoint&t="+(new Date).getTime(),document.body.appendChild(h),h.onerror=function(){r(e.ConnectionState.TOKEN_INCORRECT)},"onload"in h?h.onload=s:h.onreadystatechange=function(){"loaded"==h.readyState&&s()}},t.Endpoint=new Object,t}();e.Navigation=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(t){this._name="BaseMessage",this.lengthSize=0,t instanceof e.Header?this._header=t:this._header=new e.Header(t,!1,e.Qos.AT_MOST_ONCE,!1)}return t.prototype.read=function(e,t){this.readMessage(e,t)},t.prototype.write=function(t){var n=new e.BinaryHelper,o=n.convertStream(t);return this._headerCode=this.getHeaderFlag(),o.write(this._headerCode),this.writeMessage(o),o},t.prototype.getHeaderFlag=function(){return this._header.encode()},t.prototype.getLengthSize=function(){return this.lengthSize},t.prototype.toBytes=function(){return this.write([]).getBytesArray()},t.prototype.isRetained=function(){return this._header.retain},t.prototype.setRetained=function(e){this._header.retain=e},t.prototype.setQos=function(t){this._header.qos="[object Object]"==Object.prototype.toString.call(t)?t:e.Qos[t]},t.prototype.setDup=function(e){this._header.dup=e},t.prototype.isDup=function(){return this._header.dup},t.prototype.getType=function(){return this._header.type},t.prototype.getQos=function(){return this._header.qos},t.prototype.messageLength=function(){return 0},t.prototype.writeMessage=function(e){},t.prototype.readMessage=function(e,t){},t.prototype.init=function(e){var t,n,o=this;for(n in e)e.hasOwnProperty(n)&&(t=n.replace(/^\w/,function(e){var t=e.charCodeAt(0);return"set"+(t>=97?String.fromCharCode(-33&t):e)}),t in o&&("status"==n?o[t](disconnectStatus[e[n]]?disconnectStatus[e[n]]:e[n]):o[t](e[n])))},t}();e.BaseMessage=t;var n=function(t){function n(n){switch(t.call(this,0==arguments.length||3==arguments.length?e.Type.CONNECT:arguments[0]),this._name="ConnectMessage",this.CONNECT_HEADER_SIZE=12,this.protocolId="RCloud",this.binaryHelper=new e.BinaryHelper,this.protocolVersion=3,arguments.length){case 0:case 1:case 3:if(!arguments[0]||arguments[0].length>64)throw new Error("ConnectMessage:Client Id cannot be null and must be at most 64 characters long: "+arguments[0]);this.clientId=arguments[0],this.cleanSession=arguments[1],this.keepAlive=arguments[2]}}return __extends(n,t),n.prototype.messageLength=function(){var e=this.binaryHelper.toMQttString(this.clientId).length;return e+=this.binaryHelper.toMQttString(this.willTopic).length,e+=this.binaryHelper.toMQttString(this.will).length,e+=this.binaryHelper.toMQttString(this.appId).length,e+=this.binaryHelper.toMQttString(this.token).length,e+this.CONNECT_HEADER_SIZE},n.prototype.readMessage=function(e){this.protocolId=e.readUTF(),this.protocolVersion=e.readByte();var t=e.readByte();if(this.hasAppId=(128&t)>0,this.hasToken=(64&t)>0,this.retainWill=(32&t)>0,this.willQos=t>>3&3,this.hasWill=(4&t)>0,this.cleanSession=(32&t)>0,this.keepAlive=256*e.read()+e.read(),this.clientId=e.readUTF(),this.hasWill&&(this.willTopic=e.readUTF(),this.will=e.readUTF()),this.hasAppId)try{this.appId=e.readUTF()}catch(n){throw new Error(n)}if(this.hasToken)try{this.token=e.readUTF()}catch(n){throw new Error(n)}return e},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);t.writeUTF(this.protocolId),t.write(this.protocolVersion);var n=this.cleanSession?2:0;return n|=this.hasWill?4:0,n|=this.willQos?this.willQos>>3:0,n|=this.retainWill?32:0,n|=this.hasToken?64:0,n|=this.hasAppId?128:0,t.write(n),t.writeChar(this.keepAlive),t.writeUTF(this.clientId),this.hasWill&&(t.writeUTF(this.willTopic),t.writeUTF(this.will)),this.hasAppId&&t.writeUTF(this.appId),this.hasToken&&t.writeUTF(this.token),t},n}(t);e.ConnectMessage=n;var o=function(t){function n(n){t.call(this,0==arguments.length?e.Type.CONNACK:1==arguments.length?arguments[0]instanceof e.Header?arguments[0]:e.Type.CONNACK:null),this._name="ConnAckMessage",this.MESSAGE_LENGTH=2,this.binaryHelper=new e.BinaryHelper;var o=this;switch(arguments.length){case 0:case 1:if(!(arguments[0]instanceof e.Header)&&arguments[0]in e.ConnectionState){if(null==arguments[0])throw new Error("ConnAckMessage:The status of ConnAskMessage can't be null");o.setStatus(arguments[0])}}}return __extends(n,t),n.prototype.messageLength=function(){var e=this.MESSAGE_LENGTH;return this.userId&&(e+=this.binaryHelper.toMQttString(this.userId).length),e},n.prototype.readMessage=function(e,t){e.read();var n=+e.read();if(!(n>=0&&12>=n))throw new Error("Unsupported CONNACK code:"+n);if(this.setStatus(n),t>this.MESSAGE_LENGTH){this.setUserId(e.readUTF());var o=(e.readUTF(),e.readLong());this.setTimestamp(o)}},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);switch(t.write(128),+status){case 0:case 1:case 2:case 5:case 6:t.write(+status);break;case 3:case 4:t.write(3);break;default:throw new Error("Unsupported CONNACK code:"+status)}return this.userId&&t.writeUTF(this.userId),t},n.prototype.setStatus=function(e){this.status=e},n.prototype.setUserId=function(e){this.userId=e},n.prototype.getStatus=function(){return this.status},n.prototype.getUserId=function(){return this.userId},n.prototype.setTimestamp=function(e){this.timestrap=e},n.prototype.getTimestamp=function(){return this.timestrap},n}(t);e.ConnAckMessage=o;var s=function(t){function n(n){t.call(this,n instanceof e.Header?n:e.Type.DISCONNECT),this._name="DisconnectMessage",this.MESSAGE_LENGTH=2,this.binaryHelper=new e.BinaryHelper,n instanceof e.Header||n in e.ConnectionStatus&&(this.status=n)}return __extends(n,t),n.prototype.messageLength=function(){return this.MESSAGE_LENGTH},n.prototype.readMessage=function(e){e.read();var t=+e.read();if(!(t>=0&&5>=t))throw new Error("Unsupported CONNACK code:"+t);this.setStatus(disconnectStatus[t]?disconnectStatus[t]:t)},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);if(t.write(0),!(+status>=1&&+status<=3))throw new Error("Unsupported CONNACK code:"+status);t.write(+status-1)},n.prototype.setStatus=function(e){this.status=e},n.prototype.getStatus=function(){return this.status},n}(t);e.DisconnectMessage=s;var r=function(t){function n(n){t.call(this,n&&n instanceof e.Header?n:e.Type.PINGREQ),this._name="PingReqMessage"}return __extends(n,t),n}(t);e.PingReqMessage=r;var i=function(t){function n(n){t.call(this,n&&n instanceof e.Header?n:e.Type.PINGRESP),this._name="PingRespMessage"}return __extends(n,t),n}(t);e.PingRespMessage=i;var a=function(t){function n(n){t.call(this,n),this._name="RetryableMessage",this.binaryHelper=new e.BinaryHelper}return __extends(n,t),n.prototype.messageLength=function(){return 2},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e),n=this.getMessageId(),o=255&n,s=(65280&n)>>8;return t.write(s),t.write(o),t},n.prototype.readMessage=function(e,t){var n=256*e.read()+e.read();this.setMessageId(parseInt(n,10))},n.prototype.setMessageId=function(e){this.messageId=e},n.prototype.getMessageId=function(){return this.messageId},n}(t);e.RetryableMessage=a;var c=function(t){function n(n){t.call(this,n instanceof e.Header?n:e.Type.PUBACK),this.msgLen=2,this.date=0,this.millisecond=0,this.timestamp=0,this.binaryHelper=new e.BinaryHelper,this._name="PubAckMessage",n instanceof e.Header||t.prototype.setMessageId.call(this,n)}return __extends(n,t),n.prototype.messageLength=function(){return this.msgLen},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);a.prototype.writeMessage.call(this,t)},n.prototype.readMessage=function(e,t){a.prototype.readMessage.call(this,e),this.date=e.readInt(),this.status=256*e.read()+e.read(),this.millisecond=256*e.read()+e.read(),this.timestamp=1e3*this.date+this.millisecond,this.messageUId=e.readUTF()},n.prototype.setStatus=function(e){this.status=e},n.prototype.setTimestamp=function(e){this.timestamp=e},n.prototype.setMessageUId=function(e){this.messageUId=e},n.prototype.getStatus=function(){return this.status},n.prototype.getDate=function(){return this.date},n.prototype.getTimestamp=function(){return this.timestamp},n.prototype.getMessageUId=function(){return this.messageUId},n}(a);e.PubAckMessage=c;var u=function(t){function n(n,o,s){t.call(this,1==arguments.length&&n instanceof e.Header?n:3==arguments.length?e.Type.PUBLISH:0),this._name="PublishMessage",this.binaryHelper=new e.BinaryHelper,this.syncMsg=!1,3==arguments.length&&(this.topic=n,this.targetId=s,this.data="string"==typeof o?this.binaryHelper.toMQttString(o):o)}return __extends(n,t),n.prototype.messageLength=function(){var e=10;return e+=this.binaryHelper.toMQttString(this.topic).length,e+=this.binaryHelper.toMQttString(this.targetId).length,e+=this.data.length},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);t.writeUTF(this.topic),t.writeUTF(this.targetId),a.prototype.writeMessage.apply(this,arguments),t.write(this.data)},n.prototype.readMessage=function(e,t){var n=6;this.date=e.readInt(),this.topic=e.readUTF(),n+=this.binaryHelper.toMQttString(this.topic).length,this.targetId=e.readUTF(),n+=this.binaryHelper.toMQttString(this.targetId).length,a.prototype.readMessage.apply(this,arguments),this.data=new Array(t-n),this.data=e.read(this.data)},n.prototype.setTopic=function(e){this.topic=e},n.prototype.setData=function(e){this.data=e},n.prototype.setTargetId=function(e){this.targetId=e},n.prototype.setDate=function(e){this.date=e},n.prototype.setSyncMsg=function(e){this.syncMsg=e},n.prototype.getSyncMsg=function(){return this.syncMsg},n.prototype.getTopic=function(){return this.topic},n.prototype.getData=function(){return this.data},n.prototype.getTargetId=function(){return this.targetId},n.prototype.getDate=function(){return this.date},n}(a);e.PublishMessage=u;var g=function(t){function n(n,o,s){t.call(this,n instanceof e.Header?n:3==arguments.length?e.Type.QUERY:null),this.binaryHelper=new e.BinaryHelper,this._name="QueryMessage",3==arguments.length&&(this.data="string"==typeof o?this.binaryHelper.toMQttString(o):o,this.topic=n,this.targetId=s)}return __extends(n,t),n.prototype.messageLength=function(){var e=0;return e+=this.binaryHelper.toMQttString(this.topic).length,e+=this.binaryHelper.toMQttString(this.targetId).length,e+=2,e+=this.data.length},n.prototype.writeMessage=function(e){var t=this.binaryHelper.convertStream(e);t.writeUTF(this.topic),t.writeUTF(this.targetId),a.prototype.writeMessage.call(this,t),t.write(this.data)},n.prototype.readMessage=function(e,t){var n=0;this.topic=e.readUTF(),this.targetId=e.readUTF(),n+=this.binaryHelper.toMQttString(this.topic).length,n+=this.binaryHelper.toMQttString(this.targetId).length,this.readMessage.apply(this,arguments),n+=2,this.data=new Array(t-n),e.read(this.data)},n.prototype.setTopic=function(e){this.topic=e},n.prototype.setData=function(e){this.data=e},n.prototype.setTargetId=function(e){this.targetId=e},n.prototype.getTopic=function(){return this.topic},n.prototype.getData=function(){return this.data},n.prototype.getTargetId=function(){return this.targetId},n}(a);e.QueryMessage=g;var p=function(t){function n(n){t.call(this,n instanceof e.Header?n:e.Type.QUERYCON),this._name="QueryConMessage",n instanceof e.Header||t.prototype.setMessageId.call(this,n)}return __extends(n,t),n}(a);e.QueryConMessage=p;var h=function(t){function n(n){t.call(this,n),this._name="QueryAckMessage",this.binaryHelper=new e.BinaryHelper}return __extends(n,t),n.prototype.readMessage=function(e,t){a.prototype.readMessage.call(this,e),this.date=e.readInt(),this.setStatus(256*e.read()+e.read()),t>0&&(this.data=new Array(t-8),this.data=e.read(this.data))},n.prototype.getData=function(){return this.data},n.prototype.getStatus=function(){return this.status},n.prototype.getDate=function(){return this.date},n.prototype.setDate=function(e){this.date=e},n.prototype.setStatus=function(e){this.status=e},n.prototype.setData=function(e){this.data=e},n}(a);e.QueryAckMessage=h}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(t){var n=new e.BinaryHelper;this.out=n.convertStream(t)}return t.prototype.writeMessage=function(t){t instanceof e.BaseMessage&&t.write(this.out)},t}();e.MessageOutputStream=t;var n=function(){function t(t,n){if(n)this.flags=t.headerCode;else{var o=(new e.BinaryHelper).convertStream(t);this.flags=o.readByte(),this._in=o}this.header=new e.Header(this.flags),this.isPolling=n,this.In=t}return t.prototype.readMessage=function(){switch(this.header.getType()){case 1:this.msg=new e.ConnectMessage(this.header);break;case 2:this.msg=new e.ConnAckMessage(this.header);break;case 3:this.msg=new e.PublishMessage(this.header),this.msg.setSyncMsg(this.header.getSyncMsg());break;case 4:this.msg=new e.PubAckMessage(this.header);break;case 5:this.msg=new e.QueryMessage(this.header);break;case 6:this.msg=new e.QueryAckMessage(this.header);break;case 7:this.msg=new e.QueryConMessage(this.header);break;case 9:case 11:case 13:this.msg=new e.PingRespMessage(this.header);break;case 8:case 10:case 12:this.msg=new e.PingReqMessage(this.header);break;case 14:this.msg=new e.DisconnectMessage(this.header);break;default:throw new Error("No support for deserializing "+this.header.getType()+" messages")}return this.isPolling?this.msg.init(this.In):this.msg.read(this._in,this.In.length-1),this.msg},t}();e.MessageInputStream=n;var o=function(){function t(t,n,o,s){this.retain=!1,this.qos=e.Qos.AT_LEAST_ONCE,this.dup=!1,this.syncMsg=!1,t&&+t==t&&1==arguments.length?(this.retain=(1&t)>0,this.qos=(6&t)>>1,this.dup=(8&t)>0,this.type=t>>4&15,this.syncMsg=8==(8&t)):(this.type=t,this.retain=n,this.qos=o,this.dup=s)}return t.prototype.getSyncMsg=function(){return this.syncMsg},t.prototype.getType=function(){return this.type},t.prototype.encode=function(){var t=this;switch(this.qos){case e.Qos[0]:t.qos=e.Qos.AT_MOST_ONCE;break;case e.Qos[1]:t.qos=e.Qos.AT_LEAST_ONCE;break;case e.Qos[2]:t.qos=e.Qos.EXACTLY_ONCE;break;case e.Qos[3]:t.qos=e.Qos.DEFAULT}var n=this.type<<4;return n|=this.retain?1:0,n|=this.qos<<1,n|=this.dup?8:0},t.prototype.toString=function(){return"Header [type="+this.type+",retain="+this.retain+",qos="+this.qos+",dup="+this.dup+"]"},t}();e.Header=o;var s=function(){function e(){}return e.prototype.writeUTF=function(e,t){for(var n=[],o=0,s=0,r=e.length;r>s;s++){var i=e.charCodeAt(s);i>=0&&127>=i?(o+=1,n.push(i)):i>=128&&2047>=i?(o+=2,n.push(192|31&i>>6),n.push(128|63&i)):i>=2048&&65535>=i&&(o+=3,n.push(224|15&i>>12),n.push(128|63&i>>6),n.push(128|63&i))}for(var s=0,r=n.length;r>s;s++)n[s]>255&&(n[s]&=255);return t?n:255>=o?[0,o].concat(n):[o>>8,255&o].concat(n)},e.prototype.readUTF=function(e){if("[object String]"==Object.prototype.toString.call(e))return e;for(var t="",n=e,o=0,s=n.length;s>o;o++){n[o]<0&&(n[o]+=256);var r=n[o].toString(2),i=r.match(/^1+?(?=0)/);if(i&&8==r.length){for(var a=i[0].length,c=n[o].toString(2).slice(7-a),u=1;a>u;u++)c+=n[u+o].toString(2).slice(2);t+=String.fromCharCode(parseInt(c,2)),o+=a-1}else t+=String.fromCharCode(n[o])}return t},e.prototype.convertStream=function(e){return e instanceof r?e:new r(e)},e.prototype.toMQttString=function(e){return this.writeUTF(e)},e}();e.BinaryHelper=s;var r=function(){function e(e){this.position=0,this.writen=0,this.poolLen=0,this.binaryHelper=new s,this.pool=e,this.poolLen=e.length}return e.prototype.check=function(){return this.position>=this.pool.length},e.prototype.readInt=function(){if(this.check())return-1;for(var e="",t=0;4>t;t++){var n=this.pool[this.position++].toString(16);1==n.length&&(n="0"+n),e+=n.toString(16)}return parseInt(e,16)},e.prototype.readLong=function(){if(this.check())return-1;for(var e="",t=0;8>t;t++){var n=this.pool[this.position++].toString(16);1==n.length&&(n="0"+n),e+=n}return parseInt(e,16)},e.prototype.readTimestamp=function(){if(this.check())return-1;for(var e="",t=0;8>t;t++)e+=this.pool[this.position++].toString(16);return e=e.substring(2,8),parseInt(e,16)},e.prototype.readUTF=function(){if(this.check())return-1;var e=this.readByte()<<8|this.readByte();return this.binaryHelper.readUTF(this.pool.subarray(this.position,this.position+=e))},e.prototype.readByte=function(){if(this.check())return-1;var e=this.pool[this.position++];return e>255&&(e&=255),e},e.prototype.read=function(e){return e?this.pool.subarray(this.position,this.poolLen):this.readByte()},e.prototype.write=function(e){var t=e;return"[object array]"==Object.prototype.toString.call(t).toLowerCase()?[].push.apply(this.pool,t):+t==t&&(t>255&&(t&=255),this.pool.push(t),this.writen++),t},e.prototype.writeChar=function(e){if(+e!=e)throw new Error("writeChar:arguments type is error");this.write(e>>8&255),this.write(255&e),this.writen+=2},e.prototype.writeUTF=function(e){var t=this.binaryHelper.writeUTF(e);[].push.apply(this.pool,t),this.writen+=t.length},e.prototype.toComplements=function(){for(var e=this.pool,t=0;t<this.poolLen;t++)e[t]>128&&(e[t]-=256);return e},e.prototype.getBytesArray=function(e){return e?this.toComplements():this.pool},e}();e.RongIMStream=r}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(e){return this.connected=!1,this.isClose=!1,this.queue=[],this.empty=new Function,this._socket=e,this}return t.prototype.createTransport=function(t,n){if(!t)throw new Error("URL can't be empty");return this.url=t,this.socket=new WebSocket(e.MessageUtil.schemeArrs[e.RongIMClient.schemeType][1]+"://"+t),this.socket.binaryType="arraybuffer",this.addEvent(),this.socket},t.prototype.send=function(t){if(!this.connected&&!this.isClose)return void this.queue.push(t);if(this.isClose)throw new Error("The Connection is closed,Please open the Connection!!!");var n=new e.RongIMStream([]),o=new e.MessageOutputStream(n);o.writeMessage(t);var s=n.getBytesArray(!0),r=new Int8Array(s);return this.socket.send(r.buffer),this},t.prototype.onData=function(t){return e.MessageUtil.isArray(t)?this._socket.onMessage(new e.MessageInputStream(t).readMessage()):this._socket.onMessage(new e.MessageInputStream(e.MessageUtil.ArrayFormInput(t)).readMessage()),""},t.prototype.onClose=function(t){var n=this;n.isClose=!0,n.socket=this.empty,e.Bridge._client.clearHeartbeat(),1006!=t.code||this._status?n._status=0:n._socket.fire("StatusChanged",e.ConnectionStatus.NETWORK_UNAVAILABLE)},t.prototype.onError=function(e){throw console.log(e),new Error(e)},t.prototype.addEvent=function(){var e=this;e.socket.onopen=function(){e.connected=!0,e.isClose=!1,e.doQueue(),e._socket.fire("connect")},e.socket.onmessage=function(t){"string"==typeof t.data?e.onData(t.data.split(",")):e.onData(t.data)},e.socket.onerror=function(t){e.onError(t)},e.socket.onclose=function(t){e.onClose(t)}},t.prototype.doQueue=function(){for(var e=this,t=0,n=e.queue.length;n>t;t++)e.send(e.queue[t])},t.prototype.disconnect=function(e){var t=this;t.socket.readyState&&(t.isClose=!0,e&&(t._status=e),this.socket.close())},t.prototype.reconnect=function(){this.disconnect(),this.createTransport(this.url)},t}();e.SocketTransportation=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(e){return this.empty=new Function,this.connected=!1,this.pid=+new Date+Math.random()+"",this.queue=[],this.socket=e,this}return t.prototype.createTransport=function(t,n){if(!t)throw new Error("Url is empty,Please check it!");this.url=t;var o=e.RongIMClient._cookieHelper.getItem(e.Navigation.Endpoint.userId+"sId"),s=this;return o?(setTimeout(function(){s.onSuccess('{"status":0,"userId":"'+e.Navigation.Endpoint.userId+'","headerCode":32,"messageId":0,"sessionid":"'+o+'"}'),s.connected=!0},500),this):(this.getRequest(t,!0),this)},t.prototype.requestFactory=function(t,n,o){var s=this.XmlHttpRequest();return o&&(s.multipart=!0),s.timeout=6e4,s.open(n||"GET",e.MessageUtil.schemeArrs[e.RongIMClient.schemeType][0]+"://"+t),"POST"==n&&"setRequestHeader"in s&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=utf-8"),s},t.prototype.getRequest=function(e,t){var n=this;n.xhr=this.requestFactory(e+"&pid="+encodeURIComponent(n.pid),"GET"),"onload"in n.xhr?(n.xhr.onload=function(){n.xhr.onload=n.empty,"lost params"==this.responseText?n.onError():n.onSuccess(this.responseText,t)},n.xhr.onerror=function(){n.disconnect()}):n.xhr.onreadystatechange=function(){4==n.xhr.readyState&&(n.xhr.onreadystatechange=n.empty,/^(200|202)$/.test(n.xhr.status)?n.onSuccess(n.xhr.responseText,t):/^(400|403)$/.test(n.xhr.status)?n.onError():n.disconnect())},n.xhr.send()},t.prototype.send=function(t){var n=this;this.sendxhr=this.requestFactory(e.Navigation.Endpoint.host+"/websocket"+t.url+"&pid="+encodeURIComponent(n.pid),"POST"),"onload"in n.sendxhr?(n.sendxhr.onload=function(){n.sendxhr.onload=n.empty,n.onData(n.sendxhr.responseText)},n.sendxhr.onerror=function(){n.sendxhr.onerror=n.empty}):n.sendxhr.onreadystatechange=function(){4==n.sendxhr.readyState&&(this.onreadystatechange=this.empty,/^(202|200)$/.test(n.sendxhr.status)&&n.onData(n.sendxhr.responseText));
},n.sendxhr.send(JSON.stringify(t.data))},t.prototype.onData=function(t,n){if(t&&"lost params"!=t){var o=this,s=JSON.parse(t);return s.userId&&(e.Navigation.Endpoint.userId=s.userId),n&&e.RongIMClient._cookieHelper.setItem(e.Navigation.Endpoint.userId+"sId",n),e.MessageUtil.isArray(s)||(s=[s]),Array.forEach(s,function(t){o.socket.fire("message",new e.MessageInputStream(t,!0).readMessage())}),""}},t.prototype.XmlHttpRequest=function(){var e="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;return"undefined"!=typeof XMLHttpRequest&&e?new XMLHttpRequest:"undefined"!=typeof XDomainRequest?new XDomainRequest:new ActiveXObject("Microsoft.XMLHTTP")},t.prototype.onClose=function(){this.xhr&&(this.xhr.onload?this.xhr.onreadystatechange=this.xhr.onload=this.empty:this.xhr.onreadystatechange=this.empty,this.xhr.abort(),this.xhr=null),this.sendxhr&&(this.sendxhr.onload?this.sendxhr.onreadystatechange=this.sendxhr.onload=this.empty:this.sendxhr.onreadystatechange=this.empty,this.sendxhr.abort(),this.sendxhr=null)},t.prototype.disconnect=function(){e.RongIMClient._cookieHelper.removeItem(e.Navigation.Endpoint.userId+"sId"),e.RongIMClient._cookieHelper.removeItem(e.Navigation.Endpoint.userId+"msgId"),this.onClose()},t.prototype.reconnect=function(){this.disconnect(),this.createTransport(this.url)},t.prototype.onSuccess=function(t,n){var o=t.match(/"sessionid":"\S+?(?=")/);return this.onData(t,o?o[0].slice(13):0),/"headerCode":-32,/.test(t)?(e.RongIMClient._cookieHelper.removeItem(e.Navigation.Endpoint.userId+"sId"),void e.RongIMClient._cookieHelper.removeItem(e.Navigation.Endpoint.userId+"msgId")):(this.getRequest(e.Navigation.Endpoint.host+"/pullmsg.js?sessionid="+e.RongIMClient._cookieHelper.getItem(e.Navigation.Endpoint.userId+"sId")+"&timestrap="+encodeURIComponent((new Date).getTime()+Math.random()+"")),this.connected=!0,void(n&&this.socket.fire("connect")))},t.prototype.onError=function(){e.RongIMClient._cookieHelper.removeItem(e.Navigation.Endpoint.userId+"sId"),e.RongIMClient._cookieHelper.removeItem(e.Navigation.Endpoint.userId+"msgId"),this.onClose(),this.connected=!1,this.socket.fire("disconnect")},t}();e.PollingTransportation=t}(RongIMLib||(RongIMLib={}));var typeMapping={"RC:TxtMsg":"TextMessage","RC:ImgMsg":"ImageMessage","RC:VcMsg":"VoiceMessage","RC:ImgTextMsg":"RichContentMessage","RC:LBSMsg":"LocationMessage","RC:InfoNtf":"InformationNotificationMessage","RC:ContactNtf":"ContactNotificationMessage","RC:ProfileNtf":"ProfileNotificationMessage","RC:CmdNtf":"CommandNotificationMessage","RC:DizNtf":"DiscussionNotificationMessage","RC:CmdMsg":"CommandMessage","RC:TypSts":"TypingStatusMessage","RC:CsChaR":"ChangeModeResponseMessage","RC:CsHsR":"HandShakeResponseMessage","RC:CsEnd":"TerminateMessage","RC:CsSp":"SuspendMessage","RC:CsUpdate":"CustomerStatusUpdateMessage","RC:ReadNtf":"ReadReceiptMessage"},registerMessageTypeMapping={},HistoryMsgType={4:"qryCMsg",2:"qryDMsg",3:"qryGMsg",1:"qryPMsg",6:"qrySMsg",7:"qryPMsg",8:"qryPMsg",5:"qryPMsg"},disconnectStatus={1:6},RongIMLib;!function(RongIMLib){var Transportations=function(){function e(){}return e._TransportType=RongIMLib.Socket.WEBSOCKET,e}();RongIMLib.Transportations=Transportations;var PublicServiceMap=function(){function e(){this.publicServiceList=[]}return e.prototype.get=function(e,t){for(var n=0,o=this.publicServiceList.length;o>n;n++)if(this.publicServiceList[n].conversationType==e&&t==this.publicServiceList[n].publicServiceId)return this.publicServiceList[n]},e.prototype.add=function(e){for(var t=!0,n=this,o=0,s=this.publicServiceList.length;s>o;o++)if(n.publicServiceList[o].conversationType==e.conversationType&&e.publicServiceId==n.publicServiceList[o].publicServiceId){this.publicServiceList.unshift(this.publicServiceList.splice(o,1)[0]),t=!1;break}t&&this.publicServiceList.unshift(e)},e.prototype.replace=function(e){for(var t=this,n=0,o=this.publicServiceList.length;o>n;n++)if(t.publicServiceList[n].conversationType==e.conversationType&&e.publicServiceId==t.publicServiceList[n].publicServiceId){t.publicServiceList.splice(n,1,e);break}},e.prototype.remove=function(e,t){for(var n=this,o=0,s=this.publicServiceList.length;s>o;o++)if(n.publicServiceList[o].conversationType==e&&t==n.publicServiceList[o].publicServiceId){this.publicServiceList.splice(o,1);break}},e}();RongIMLib.PublicServiceMap=PublicServiceMap;var ConversationMap=function(){function e(){this.conversationList=[]}return e.prototype.get=function(e,t){for(var n=0,o=this.conversationList.length;o>n;n++)if(this.conversationList[n].conversationType==e&&this.conversationList[n].targetId==t)return this.conversationList[n];return null},e.prototype.add=function(e){for(var t=!0,n=0,o=this.conversationList.length;o>n;n++)if(this.conversationList[n].conversationType===e.conversationType&&this.conversationList[n].targetId===e.targetId){this.conversationList.unshift(this.conversationList.splice(n,1)[0]),t=!1;break}t&&this.conversationList.unshift(e)},e.prototype.replace=function(e){for(var t=0,n=this.conversationList.length;n>t;t++)if(this.conversationList[t].conversationType===e.conversationType&&this.conversationList[t].targetId===e.targetId){this.conversationList.splice(t,1,e);break}},e.prototype.remove=function(e){for(var t=0,n=this.conversationList.length;n>t;t++)if(this.conversationList[t].conversationType===e.conversationType&&this.conversationList[t].targetId===e.targetId){this.conversationList.splice(t,1);break}},e}();RongIMLib.ConversationMap=ConversationMap;var MessageUtil=function(){function MessageUtil(){}return MessageUtil.supportLargeStorage=function(){return!!window.localStorage},MessageUtil.checkStorageSize=function(){return JSON.stringify(localStorage).length<468e4},MessageUtil.ArrayForm=function(e){if("[object ArrayBuffer]"==Object.prototype.toString.call(e)){var t=new Int8Array(e);return[].slice.call(t)}return e},MessageUtil.ArrayFormInput=function(e){if("[object ArrayBuffer]"==Object.prototype.toString.call(e)){var t=new Uint8Array(e);return t}return e},MessageUtil.indexOf=function(e,t,n){for(var o=e.length,s=0>n?Math.max(0,+n):n||0;o>s;s++)if(e[s]==t)return s;return-1},MessageUtil.isArray=function(e){return"[object Array]"==Object.prototype.toString.call(e)},MessageUtil.forEach=function(e,t){return[].forEach?function(e,t){[].forEach.call(e,t)}:function(e,t){for(var n=0;n<e.length;n++)t.call(e,e[n],n,e)}},MessageUtil.remove=function(e,t){for(var n=0,o=e.length;o>n;n++)if(t(e[n]))return e.splice(n,1)[0];return null},MessageUtil.int64ToTimestamp=function(e,t){if(void 0===e.low)return e;var n=e.low;0>n&&(n+=4294967296),n=n.toString(16);var o=parseInt(e.high.toString(16)+"00000000".replace(new RegExp("0{"+n.length+"}$"),n),16);return t?new Date(o):o},MessageUtil.messageParser=function(entity,onReceived){var message=new RongIMLib.Message,content=entity.content,de,objectName=entity.classname,val,isUseDef=!1;try{RongIMLib.RongIMClient._memoryStore.global.WEB_XHR_POLLING?(val=(new RongIMLib.BinaryHelper).readUTF(content.offset?MessageUtil.ArrayForm(content.buffer).slice(content.offset,content.limit):content),de=JSON.parse(val)):(val=(new RongIMLib.BinaryHelper).readUTF(content.offset?MessageUtil.ArrayFormInput(content.buffer).subarray(content.offset,content.limit):content),de=JSON.parse(val))}catch(ex){de=val,isUseDef=!0}if(objectName in typeMapping){var str="new RongIMLib."+typeMapping[objectName]+"(de)";message.content=eval(str),message.messageType=typeMapping[objectName]}else if(objectName in registerMessageTypeMapping){var str="new RongIMLib.RongIMClient.RegisterMessage."+registerMessageTypeMapping[objectName]+"(de)";isUseDef?message.content=eval(str).decode(de):message.content=eval(str),message.messageType=registerMessageTypeMapping[objectName]}else message.content=new RongIMLib.UnknownMessage({content:de,objectName:objectName}),message.messageType="UnknownMessage";return message.sentTime=MessageUtil.int64ToTimestamp(entity.dataTime),message.senderUserId=entity.fromUserId,message.conversationType=entity.type,entity.fromUserId==RongIMLib.Bridge._client.userId?message.targetId=entity.groupId:message.targetId=/^[234]$/.test(entity.type||entity.getType())?entity.groupId:message.senderUserId,1==entity.direction?(message.messageDirection=RongIMLib.MessageDirection.SEND,message.senderUserId=RongIMLib.Bridge._client.userId):message.senderUserId==RongIMLib.Bridge._client.userId?message.messageDirection=RongIMLib.MessageDirection.SEND:message.messageDirection=RongIMLib.MessageDirection.RECEIVE,2==(2&entity.status)&&(message.receivedStatus=RongIMLib.ReceivedStatus.RETRIEVED),message.messageUId=entity.msgId,message.receivedTime=(new Date).getTime(),message.messageId=message.conversationType+"_"+~~(16777215*Math.random()),message.objectName=objectName,message},MessageUtil.schemeArrs=[["http","ws"],["https","wss"]],MessageUtil.sign={converNum:1,msgNum:1,isMsgStart:!0,isConvStart:!0},MessageUtil}();RongIMLib.MessageUtil=MessageUtil;var MessageIdHandler=function(){function e(){}return e.init=function(){this.messageId=+(RongIMLib.RongIMClient._cookieHelper.getItem(RongIMLib.Navigation.Endpoint.userId+"msgId")||RongIMLib.RongIMClient._cookieHelper.setItem(RongIMLib.Navigation.Endpoint.userId+"msgId",0)||0)},e.messageIdPlus=function(e){return this.isXHR&&this.init(),this.messageId>=65535?(e(),!1):(this.messageId++,this.isXHR&&RongIMLib.RongIMClient._cookieHelper.setItem(RongIMLib.Navigation.Endpoint.userId+"msgId",this.messageId),this.messageId)},e.clearMessageId=function(){this.messageId=0,this.isXHR&&RongIMLib.RongIMClient._cookieHelper.setItem(RongIMLib.Navigation.Endpoint.userId+"msgId",this.messageId)},e.getMessageId=function(){return this.isXHR&&this.init(),this.messageId},e.messageId=0,e.isXHR=window.WEB_XHR_POLLING,e}();RongIMLib.MessageIdHandler=MessageIdHandler;var CheckParam=function(){function e(){}return e.getInstance=function(){return new e},e.prototype.check=function(e,t,n){var o=arguments.callee.caller;if(!("_client"in RongIMLib.Bridge||n))throw new Error("The parameter is incorrect or was not yet instantiated RongIMClient -> position:"+t);for(var s=0,r=o.arguments.length;r>s;s++)if(!new RegExp(this.getType(o.arguments[s])).test(e[s]))throw new Error("The index of "+s+" parameter was wrong type "+this.getType(o.arguments[s])+" ["+e[s]+"] -> position:"+t)},e.prototype.getType=function(e){var t=Object.prototype.toString.call(e).toLowerCase();return t.slice(8,t.length-1)},e}();RongIMLib.CheckParam=CheckParam;var LimitableMap=function(){function e(e){this.map={},this.keys=[],this.limit=e||10}return e.prototype.set=function(e,t){if(this.map.hasOwnProperty(e)){if(this.keys.length===this.limit){var n=this.keys.shift();delete this.map[n]}this.keys.push(e)}this.map[e]=t},e.prototype.get=function(e){return this.map[e]||0},e.prototype.remove=function(e){delete this.map[e]},e}();RongIMLib.LimitableMap=LimitableMap}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function e(e){throw new Error("This method is abstract, you must implement this method in inherited class.")}return e.obtain=function(){throw new Error("This method is abstract, you must implement this method in inherited class.")},e}();e.MessageContent=t;var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.NotificationMessage=n;var o=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t}(t);e.StatusMessage=o;var s=function(){function t(){}return t.modelClone=function(e){var t={};for(var n in e)"messageName"!=n&&"encode"!=n&&(t[n]=e[n]);return t},t.modleCreate=function(t,n){if(t.length<1)throw new Error("Array is empty  -> registerMessageType.modleCreate");var o=function(s){var r=this;for(var i in t)s[t[i]]&&(r[t[i]]=s[t[i]]);o.prototype.messageName=n,o.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))}};return o},t}();e.ModelUtil=s}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(e){this.messageName="CustomerStatusMessage",this.status=e.status}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CustomerStatusMessage=t;var n=function(){function t(e){this.messageName="ChangeModeResponseMessage",this.code=e.code,this.data=e.data,this.msg=e.msg}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ChangeModeResponseMessage=n;var o=function(){function t(e){this.messageName="ChangeModeMessage",this.uid=e.uid,this.sid=e.sid,this.pid=e.pid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ChangeModeMessage=o;var s=function(){function t(e){this.messageName="CustomerStatusUpdateMessage",this.serviceStatus=e.serviceStatus,this.sid=e.sid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CustomerStatusUpdateMessage=s;var r=function(){function t(){this.messageName="HandShakeMessage"}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.HandShakeMessage=r;var i=function(){function t(e){this.messageName="EvaluateMessage",this.uid=e.uid,this.sid=e.sid,this.pid=e.pid,this.source=e.source,this.suggest=e.suggest,this.isRobotResolved=e.isRobotResolved,this.type=e.type}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.EvaluateMessage=i;var a=function(){function t(e){this.messageName="HandShakeResponseMessage",this.msg=e.msg,this.status=e.status,this.data=e.data}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.HandShakeResponseMessage=a;var c=function(){function t(e){this.messageName="SuspendMessage",this.uid=e.uid,this.sid=e.sid,this.pid=e.pid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.SuspendMessage=c;var u=function(){function t(e){this.messageName="TerminateMessage",this.code=e.code,this.msg=e.msg,this.sid=e.sid}return t.obtain=function(){return null},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.TerminateMessage=u}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function e(e){this.messageName="IsTypingStatusMessage"}return e.prototype.encode=function(){},e.prototype.getMessage=function(){return null},e}();e.IsTypingStatusMessage=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(e){if(this.messageName="InformationNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> InformationNotificationMessage.");this.message=e.message,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e){return new t({message:e,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.InformationNotificationMessage=t;var n=function(){function t(e){if(this.messageName="CommandMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> CommandMessage.");try{"[object String]"==Object.prototype.toString.call(e.data)?this.data=JSON.parse(e.data):this.data=e.data}catch(t){this.data=e.data}this.name=e.name,this.extra=e.extra}return t.obtain=function(e){return new t({data:e,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CommandMessage=n;var o=function(){function n(e){if(this.messageName="ContactNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ContactNotificationMessage.");this.operation=e.operation,this.targetUserId=e.targetUserId,this.message=e.message,this.extra=e.extra,this.sourceUserId=e.sourceUserId,e.user&&(this.user=e.user)}return n.obtain=function(e,n,o,s){return new t({operation:e,sourceUserId:n,targetUserId:o,message:s})},n.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},n.CONTACT_OPERATION_ACCEPT_RESPONSE="ContactOperationAcceptResponse",n.CONTACT_OPERATION_REJECT_RESPONSE="ContactOperationRejectResponse",n.CONTACT_OPERATION_REQUEST="ContactOperationRequest",n}();e.ContactNotificationMessage=o;var s=function(){function t(e){if(this.messageName="ProfileNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ProfileNotificationMessage.");this.operation=e.operation;try{"[object String]"==Object.prototype.toString.call(e.data)?this.data=JSON.parse(e.data):this.data=e.data}catch(t){this.data=e.data}this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e,n){return new t({operation:e,data:n})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ProfileNotificationMessage=s;var r=function(){function t(e){if(this.messageName="CommandNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ProfileNotificationMessage.");try{"[object String]"==Object.prototype.toString.call(e.data)?this.data=JSON.parse(e.data):this.data=e.data}catch(t){this.data=e.data}this.name=e.name,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e,n){return new t({name:e,data:n,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.CommandNotificationMessage=r;var i=function(){function t(e){if(this.messageName="DiscussionNotificationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> DiscussionNotificationMessage.");this.extra=e.extra,this.extension=e.extension,this.type=e.type,this.isHasReceived=e.isHasReceived,this.operation=e.operation,this.user=e.user,e.user&&(this.user=e.user)}return t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.DiscussionNotificationMessage=i}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(e){if(this.messageName="TextMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> TextMessage.");this.content=e.content,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e){return new t({extra:"",content:e})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.TextMessage=t;var n=function(){function t(e){if(this.messageName="TypingStatusMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> TypingStatusMessage.");this.typingContentType=e.typingContentType,this.data=e.data}return t.obtain=function(e,n){return new t({typingContentType:e,data:n})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.TypingStatusMessage=n;var o=function(){function t(e){if(this.messageName="ReadReceiptMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ReadReceiptMessage.");this.lastMessageSendTime=e.lastMessageSendTime,this.messageUId=e.messageUId,this.type=e.type}return t.obtain=function(e,n,o){return new t({messageUId:e,lastMessageSendTime:n,type:o})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ReadReceiptMessage=o;var s=function(){function t(e){if(this.messageName="VoiceMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> VoiceMessage.");this.content=e.content,this.duration=e.duration,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e,n){return new t({content:e,duration:n,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.VoiceMessage=s;var r=function(){function t(e){if(this.messageName="ImageMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> ImageMessage.");this.content=e.content,this.imageUri=e.imageUri,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e,n){return new t({content:e,imageUri:n,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.ImageMessage=r;var i=function(){function t(e){if(this.messageName="LocationMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> LocationMessage.");this.latiude=e.latitude,this.longitude=e.longitude,this.poi=e.poi,this.content=e.content,this.extra=e.extra,e.user&&(this.user=e.user)}return t.obtain=function(e,n,o,s){return new t({latitude:n,longitude:n,poi:o,content:s,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.LocationMessage=i;var a=function(){function t(e){if(this.messageName="RichContentMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> RichContentMessage.");this.title=e.title,this.content=e.content,this.imageUri=e.imageUri,this.extra=e.extra,this.url=e.url,e.user&&(this.user=e.user)}return t.obtain=function(e,n,o,s){return new t({title:e,content:n,imageUri:o,url:s,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.RichContentMessage=a;var c=function(){function e(e){if(this.messageName="UnknownMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> UnknownMessage.");this.message=e}return e.prototype.encode=function(){return""},e}();e.UnknownMessage=c;var u=function(){function t(e){if(this.messageName="PublicServiceCommandMessage",0==arguments.length)throw new Error("Can not instantiate with empty parameters, use obtain method instead -> PublicServiceCommandMessage.");this.content=e.content,this.extra=e.extra,this.menuItem=e.menuItem,e.user&&(this.user=e.user)}return t.obtain=function(e){return new t({content:"",command:"",menuItem:e,extra:""})},t.prototype.encode=function(){return JSON.stringify(e.ModelUtil.modelClone(this))},t}();e.PublicServiceCommandMessage=u;var g=function(){function e(e){this.messageName="PublicServiceMultiRichContentMessage",this.richContentMessages=e}return e.prototype.encode=function(){return null},e}();e.PublicServiceMultiRichContentMessage=g;var p=function(){function e(e){this.messageName="PublicServiceRichContentMessage",this.richContentMessage=e}return e.prototype.encode=function(){return null},e}();e.PublicServiceRichContentMessage=p}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function e(e,t,n){}return e}();e.CustomServiceConfig=t;var n=function(){function e(e,t,n,o,s,r,i){}return e}();e.CustomServiceSession=n;var o=function(){function t(e,t,n,o,s,r,i,a,c,u,g,p,h,d,f,l,m){this.conversationTitle=e,this.conversationType=t,this.draft=n,this.isTop=o,this.latestMessage=s,this.latestMessageId=r,this.notificationStatus=i,this.objectName=a,this.receivedStatus=c,this.receivedTime=u,this.senderUserId=g,this.senderUserName=p,this.sentStatus=h,this.sentTime=d,this.targetId=f,this.unreadMessageCount=l,this.senderPortraitUri=m}return t.prototype.setTop=function(){e.RongIMClient._dataAccessProvider.addConversation(this,{onSuccess:function(e){}})},t}();e.Conversation=o;var s=function(){function e(e,t,n,o,s){this.creatorId=e,this.id=t,this.memberIdList=n,this.name=o,this.isOpen=s}return e}();e.Discussion=s;var r=function(){function e(e,t,n){this.id=e,this.name=t,this.portraitUri=n}return e}();e.Group=r;var i=function(){function e(e,t,n,o,s,r,i,a,c,u,g,p,h,d,f){this.content=e,this.conversationType=t,this.extra=n,this.objectName=o,this.messageDirection=s,this.messageId=r,this.receivedStatus=i,this.receivedTime=a,this.senderUserId=c,this.sentStatus=u,this.sentTime=g,this.targetId=p,this.messageType=h,this.messageUId=d,this.isLocalMessage=f}return e}();e.Message=i;var a=function(){function e(e,t){this.isCounted=e,this.isPersited=t}return e.prototype.getMessageTag=function(){return this.isCounted&&this.isPersited?3:this.isCounted||!this.isPersited?2:!this.isCounted||this.isPersited?1:this.isCounted||this.isPersited?void 0:0},e}();e.MessageTag=a;var c=function(){function e(e,t,n,o,s){this.id=e,this.name=t,this.type=n,this.sunMenuItems=o,this.url=s}return e}();e.PublicServiceMenuItem=c;var u=function(){function e(e,t,n,o,s,r,i,a){this.conversationType=e,this.introduction=t,this.menu=n,this.name=o,this.portraitUri=s,this.publicServiceId=r,this.hasFollowed=i,this.isGlobal=a}return e}();e.PublicServiceProfile=u;var g=function(){function e(e,t,n){this.userId=e,this.name=t,this.icon=n}return e}();e.UserInfo=g}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(){this.database=new e.DBUtil}return t.prototype.addConversation=function(t,n){for(var o=!0,s=0,r=e.RongIMClient._memoryStore.conversationList.length;r>s;s++)if(e.RongIMClient._memoryStore.conversationList[s].conversationType===t.conversationType&&e.RongIMClient._memoryStore.conversationList[s].targetId===t.targetId){e.RongIMClient._memoryStore.conversationList.unshift(e.RongIMClient._memoryStore.conversationList.splice(s,1)[0]),o=!1;break}o&&e.RongIMClient._memoryStore.conversationList.unshift(t),n.onSuccess(!0)},t.prototype.updateConversation=function(t){for(var n,o=0,s=e.RongIMClient._memoryStore.conversationList.length;s>o;o++)if(t.conversationType===e.RongIMClient._memoryStore.conversationList[o].conversationType&&t.targetId===e.RongIMClient._memoryStore.conversationList[o].targetId){e.RongIMClient._memoryStore.conversationList[o].conversationTitle=t.conversationTitle,e.RongIMClient._memoryStore.conversationList[o].senderUserName=t.senderUserName,e.RongIMClient._memoryStore.conversationList[o].senderPortraitUri=t.senderPortraitUri;break}return n},t.prototype.removeConversation=function(t,n,o){for(var s=0,r=e.RongIMClient._memoryStore.conversationList.length;r>s;s++)if(e.RongIMClient._memoryStore.conversationList[s].conversationType===t&&e.RongIMClient._memoryStore.conversationList[s].targetId===n){e.RongIMClient._memoryStore.conversationList.splice(s,1),e.MessageUtil.supportLargeStorage()&&e.LocalStorageProvider.getInstance().removeItem("cu"+e.Bridge._client.userId+t+n);break}o.onSuccess(!0)},t.prototype.getMessage=function(t,n){n.onSuccess(new e.Message)},t.prototype.addMessage=function(e,t,n,o){o&&o.onSuccess(n)},t.prototype.removeMessage=function(e,t,n,o){o.onSuccess(!0)},t.prototype.removeLocalMessage=function(e,t,n,o){o.onSuccess(!0)},t.prototype.updateMessage=function(e,t){t&&t.onSuccess(e)},t.prototype.clearMessages=function(e,t,n){n.onSuccess(!0)},t.prototype.updateMessages=function(t,n,o,s,r){var i=this;"readStatus"==o&&e.RongIMClient._memoryStore.conversationList.length>0&&i.getConversationList({onSuccess:function(e){Array.forEach(e,function(e){e.conversationType==t&&e.targetId==n&&(e.unreadMessageCount=0)})},onError:function(e){r.onError(e)}},null),r.onSuccess(!0)},t.prototype.getConversation=function(t,n,o){for(var s=null,r=0,i=e.RongIMClient._memoryStore.conversationList.length;i>r;r++)if(e.RongIMClient._memoryStore.conversationList[r].conversationType==t&&e.RongIMClient._memoryStore.conversationList[r].targetId==n&&(s=e.RongIMClient._memoryStore.conversationList[r],e.MessageUtil.supportLargeStorage())){var a=e.LocalStorageProvider.getInstance().getItem("cu"+e.Bridge._client.userId+t+n);0==s.unreadMessageCount&&(s.unreadMessageCount=Number(a))}o.onSuccess(s)},t.prototype.getConversationList=function(t,n){if(0==e.RongIMClient._memoryStore.conversationList.length||e.RongIMClient._memoryStore.isSyncRemoteConverList)e.RongIMClient.getInstance().getRemoteConversationList({onSuccess:function(n){e.MessageUtil.supportLargeStorage()&&Array.forEach(e.RongIMClient._memoryStore.conversationList,function(t){var n=e.LocalStorageProvider.getInstance().getItem("cu"+e.Bridge._client.userId+t.conversationType+t.targetId);0==t.unreadMessageCount&&(t.unreadMessageCount=Number(n))}),e.RongIMClient._memoryStore.isSyncRemoteConverList=!1,t.onSuccess(n)},onError:function(e){t.onSuccess([])}},n);else if(n){var o=[];Array.forEach(n,function(t){Array.forEach(e.RongIMClient._memoryStore.conversationList,function(e){e.conversationType==t&&o.push(e)})}),t.onSuccess(o)}else t.onSuccess(e.RongIMClient._memoryStore.conversationList)},t.prototype.clearConversations=function(t,n){Array.forEach(t,function(t){Array.forEach(e.RongIMClient._memoryStore.conversationList,function(n){t==n.conversationType&&e.RongIMClient.getInstance().removeConversation(n.conversationType,n.targetId,{onSuccess:function(){},onError:function(){}})})}),n.onSuccess(!0)},t.prototype.getHistoryMessages=function(t,n,o,s,r){e.RongIMClient.getInstance().getRemoteHistoryMessages(t,n,o,s,r)},t.prototype.getTotalUnreadCount=function(t){var n=0;Array.forEach(e.RongIMClient._memoryStore.conversationList,function(e){n+=e.unreadMessageCount}),t.onSuccess(n)},t.prototype.getConversationUnreadCount=function(t,n){var o=0;Array.forEach(t,function(t){Array.forEach(e.RongIMClient._memoryStore.conversationList,function(e){e.conversationType==t&&(o+=e.unreadMessageCount)})}),n.onSuccess(o)},t.prototype.getUnreadCount=function(e,t,n){this.getConversation(e,t,{onSuccess:function(e){n.onSuccess(e?e.unreadMessageCount:0)},onError:function(e){n.onError(e)}})},t.prototype.clearUnreadCount=function(t,n,o){this.getConversation(t,n,{onSuccess:function(s){s&&(e.MessageUtil.supportLargeStorage()&&e.LocalStorageProvider.getInstance().removeItem("cu"+e.Bridge._client.userId+t+n),s.unreadMessageCount=0),o.onSuccess(!0)},onError:function(e){o.onError(e)}})},t.prototype.setConversationToTop=function(e,t,n){var o=this;this.getConversation(e,t,{onSuccess:function(e){o.addConversation(e,n),n.onSuccess(!0)},onError:function(e){n.onError(e)}})},t.prototype.setMessageExtra=function(e,t,n){n.onSuccess(!0)},t.prototype.setMessageReceivedStatus=function(e,t,n){n.onSuccess(!0)},t.prototype.setMessageSentStatus=function(e,t,n){n.onSuccess(!0)},t}();e.ServerDataProvider=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function e(){}return e.prototype.init=function(e){var t=this,n=!1;if(t.userId=e,t.db=openDatabase("RongIMLibDB","1.0","RongIMLibDB",10485760),t.db){n=!0;var o="create table if not exists t_conversation_"+e+" (conversationType,targetId,content,sentTime,isTop)",s="create table if not exists t_message_"+e+" (id integer not null primary key autoincrement,messageType,messageUId,conversationType,targetId,sentTime,content,localMsg)";t.execUpdate(o),t.execUpdate(s)}return n},e.prototype.execSearchByParams=function(e,t,n){this.db.transaction(function(o){o.executeSql(e,t,function(e,t){n(t.rows)},function(e,t){throw new Error("{errorCode:"+t.code+",content:"+t.message+"}")})})},e.prototype.execSearch=function(e,t){this.db.transaction(function(n){n.executeSql(e,[],function(e,n){t(n.rows)},function(e,t){throw new Error("{errorCode:"+t.code+",content:"+t.message+"}")})})},e.prototype.execUpdateByParams=function(e,t){this.db.transaction(function(n){n.executeSql(e,t)},function(e,t){throw new Error("{errorCode:"+e.code+",content:"+e.message+"}")})},e.prototype.execUpdate=function(e){this.db.transaction(function(t){t.executeSql(e)},function(e,t){throw new Error("{errorCode:"+e.code+",content:"+e.message+"}")})},e}();e.DBUtil=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(){this.database=new e.DBUtil}return t.prototype.updateConversation=function(e){var t="update t_conversation_"+this.database.userId+" set content = ?,sentTime = ?,istop = ? where conversationType = ? and targetId = ?";return this.database.execUpdateByParams(t,[JSON.stringify(e),e.sentTime,e.isTop,e.conversationType,e.targetId]),
e},t.prototype.addConversation=function(e,t){var n=this,o="select * from t_conversation_"+n.database.userId+" t where t.conversationType = ? and t.targetId = ?";n.database.execSearchByParams(o,[Number(e.conversationType),e.targetId],function(o){if(o.length>0)n.updateConversation(e);else{var s="insert into t_conversation_"+n.database.userId+"(conversationType,targetId,content,sentTime,isTop) values(?,?,?,?,?)";n.database.execUpdateByParams(s,[e.conversationType,e.targetId,JSON.stringify(e),e.sentTime,e.isTop])}t.onSuccess(!0)})},t.prototype.removeConversation=function(e,t,n){var o="delete from t_conversation_"+this.database.userId+"  where conversationType = ? and targetId = ?";this.database.execUpdateByParams(o,[e,t]),n.onSuccess(!0)},t.prototype.getConversation=function(e,t,n){var o="select t.content from t_conversation_"+this.database.userId+" t where t.conversationType = ? and t.targetId = ?";this.database.execSearchByParams(o,[Number(e),t],function(e){var t;e.length>0&&(t=JSON.parse(e[0].content)),n.onSuccess(t)})},t.prototype.getConversationList=function(t,n){e.RongIMClient._memoryStore.isSyncRemoteConverList&&e.RongIMClient.getInstance().getRemoteConversationList({onSuccess:function(t){e.RongIMClient._memoryStore.conversationList=t;for(var n=0,o=t.length;o>n;n++)r.addConversation(t[n],{onSuccess:function(){},onError:function(){}});e.RongIMClient._memoryStore.isSyncRemoteConverList=!1},onError:function(e){t.onError(e)}},null);var o="select * from t_conversation_"+this.database.userId+" t where t.isTop = 1 ",s="select * from t_conversation_"+this.database.userId+" c where c.isTop != 1 order by c.sentTime ",r=this;n&&(o+=" and t.conversationType in ("+n.join(",")+")",s+=" and c.conversationType in ("+n.join(",")+")"),o+=" union "+s,this.database.execSearch(o,function(n){if(n.length>0){for(var o=[],s=0,r=n.length;r>s;s++)o.push(JSON.parse(n[s].content));e.RongIMClient._memoryStore.conversationList=o}t.onSuccess(e.RongIMClient._memoryStore.conversationList)})},t.prototype.clearConversations=function(t,n){var o="delete from t_conversation_"+this.database.userId+" where conversationType in (?)";this.database.execUpdateByParams(o,[t.join(",")]),Array.forEach(t,function(t){Array.forEach(e.RongIMClient._memoryStore.conversationList,function(n){t==n.conversationType&&e.RongIMClient.getInstance().removeConversation(n.conversationType,n.targetId,{onSuccess:function(){},onError:function(){}})})}),n.onSuccess(!0)},t.prototype.getMessage=function(e,t){var n="select * from t_message_"+this.database.userId+" t where t.id = ?";this.database.execSearchByParams(n,[e],function(e){if(e.length>0){var n=JSON.parse(e[0].content);t.onSuccess(n)}else t.onSuccess(null)})},t.prototype.addMessage=function(e,t,n,o){var s="insert into t_message_"+this.database.userId+" (messageType,messageUId,conversationType,targetId,sentTime,content,localMsg)values(?,?,?,?,?,?,?)",r=n.messageUId?0:1;if(this.database.execUpdateByParams(s,[n.messageType,n.messageUId,n.conversationType,n.targetId,n.sentTime,JSON.stringify(n),r]),o){var i="select t.id from t_message_"+this.database.userId+" t where t.sentTime = ? and t.conversationType = ? and t.targetId = ?";this.database.execSearchByParams(i,[n.sentTime,e,t],function(e){n.messageId=e[0].id,o.onSuccess(n)})}},t.prototype.removeMessage=function(e,t,n,o){if(0!=n.length){var s="delete from t_message_"+this.database.userId+" where messageUId in (?)";this.database.execUpdateByParams(s,[n.join(",")])}},t.prototype.removeLocalMessage=function(e,t,n,o){if(0!=n.length){var s="delete from t_message_"+this.database.userId+" where id in ("+n.join(",")+") and conversationType = ? and targetId = ? and localMsg = 1";this.database.execUpdateByParams(s,[e,t]),o.onSuccess(!0)}},t.prototype.updateMessage=function(e,t){var n="update t_message_"+this.database.userId+" set messageUId = ?,sentTime = ?,content = ?,localMsg = ? where id = ?";this.database.execUpdateByParams(n,[e.messageUId,e.sentTime,JSON.stringify(e),e.isLocalMessage,e.messageId])},t.prototype.updateMessages=function(e,t,n,o,s){throw new Error("Not implemented yet")},t.prototype.clearMessages=function(e,t,n){var o="delete from t_message_"+this.database.userId+" where conversationType = ? and targetId = ? ";this.database.execUpdateByParams(o,[e,t]),n.onSuccess(!0)},t.prototype.getHistoryMessages=function(t,n,o,s,r){var i="select * from (select * from t_message_"+this.database.userId+" t where t.conversationType = ? and t.targetId = ? ",a=[t,n],c=[],u=this;if(0!==o){var g=e.RongIMClient._memoryStore.lastReadTime.get(t+n);0!=g&&(i+="and t.sentTime < ? ",a.push(g),o=g)}i+="order by t.sentTime desc limit ?) order by sentTime ",a.push(s),u.database.execSearchByParams(i,a,function(g){for(var p=0,h=g.length;h>p;p++)c.push(JSON.parse(g[p].content));s>h?e.RongIMClient.getInstance().getRemoteHistoryMessages(t,n,o,s-g.length,{onSuccess:function(t,o){for(var s=0,c=t.length;c>s;s++)t[s].targetId?null:t[s].targetId=n,e.RongIMClient._dataAccessProvider.addMessage(t[s].conversationType,t[s].targetId,t[s],{onSuccess:function(e){},onError:function(){}});u.database.execSearchByParams(i,a,function(e){for(var t=[],n=0,s=e.length;s>n;n++)t.push(JSON.parse(e[n].content));r.onSuccess(t,o)})},onError:function(e){}}):(r.onSuccess(c,!0),e.RongIMClient._memoryStore.lastReadTime.set(t+n,g[h-1].sentTime))})},t.prototype.getTotalUnreadCount=function(e){var t="select t.content from t_conversation_"+this.database.userId+" t";this.database.execSearch(t,function(t){for(var n=0,o=0,s=t.length;s>o;o++){var r=JSON.parse(t[o].content);n+=r.unreadMessageCount}e.onSuccess(n)})},t.prototype.getConversationUnreadCount=function(e,t){if(0==e.length)return void t.onSuccess(0);var n="select t.content from t_conversation_"+this.database.userId+" t where t.conversationType in ("+e.join(",")+")";this.database.execSearchByParams(n,[],function(e){for(var n=0,o=0,s=e.length;s>o;o++){var r=JSON.parse(e[o].content);n+=r.unreadMessageCount}t.onSuccess(n)})},t.prototype.getUnreadCount=function(e,t,n){var o="select t.content from t_conversation_"+this.database.userId+" t where t.conversationType = ? and t.targetId = ?";this.database.execSearchByParams(o,[e,t],function(e){for(var t=0,o=0,s=e.length;s>o;o++){var r=JSON.parse(e[o].content);t+=r.unreadMessageCount}n.onSuccess(t)})},t.prototype.clearUnreadCount=function(e,t,n){var o="select * from t_conversation_"+this.database.userId+" t where t.conversationType = ? and t.targetId = ?",s="update t_conversation_"+this.database.userId+" set content = ? where conversationType = ? and targetId = ?",r=this;this.database.execSearchByParams(o,[e,t],function(o){if(0==o.length)n.onSuccess(!1);else{var i=JSON.parse(o[0].content);i.unreadMessageCount=0,r.database.execUpdateByParams(s,[JSON.stringify(i),e,t]),n.onSuccess(!0)}})},t.prototype.setConversationToTop=function(e,t,n){var o="update t_conversation_"+this.database.userId+" set isTop = 1 where conversationType = ? and targetId = ?";this.database.execUpdateByParams(o,[e,t]),n.onSuccess(!0)},t.prototype.setMessageExtra=function(e,t,n){var o="select t.content from t_message_"+this.database.userId+" t where t.messageUId = ?",s="UPADTE t_message_"+this.database.userId+" t SET t.content = ? where t.messageUId = ?";this.database.execSearchByParams(o,[e],function(o){if(0==o.length)n.onSuccess(!1);else{var r=JSON.parse(o[0].content);r.extra=t,this.database.execUpdateByParams(s,[JSON.stringify(r),e])}})},t.prototype.setMessageReceivedStatus=function(e,t,n){var o="select t.content from t_message_"+this.database.userId+" t where t.messageUId = ?",s="update t_message_"+this.database.userId+" set content = ? where messageUId = ?",r=this;this.database.execSearchByParams(o,[e],function(o){if(0==o.length)n.onSuccess(!1);else{var i=JSON.parse(o[0].content);i.receivedStatus=t,r.database.execUpdateByParams(s,[JSON.stringify(i),e]),n.onSuccess(!0)}})},t.prototype.dropTable=function(e){this.database.execUpdate(e)},t.prototype.setMessageSentStatus=function(e,t,n){var o="select t.content from t_message_"+this.database.userId+" t where t.messageUId = ?",s="update t_message_"+this.database.userId+" set content = ? where messageUId = ?";this.database.execSearchByParams(o,[e],function(o){if(0==o.length)n.onSuccess(!1);else{var r=JSON.parse(o[0].content);r.sentStatus=t,this.database.execUpdateByParams(s,[JSON.stringify(r),e]),n.onSuccess(!0)}})},t}();e.WebSQLDataProvider=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function e(){}return e.prototype.setItem=function(e,t){var n=new Date;n.setTime(n.getTime()+1296e6),document.cookie=e+"="+decodeURIComponent(t)+";path=/;expires="+n.toGMTString()},e.prototype.getItem=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?t[2]:null},e.prototype.removeItem=function(e){this.getItem(e)&&(document.cookie=e+"=;path=/;expires=Thu, 01-Jan-1970 00:00:01 GMT")},e.prototype.getItemKey=function(e){var t=document.cookie.match(new RegExp("(^| )navi\\w+?=([^;]*)(;|$)")),n="";if(t)for(var o=0,s=t.length;s>o;o++)if(t[o].indexOf(e)>-1){n=t[o];break}return n?n.split("=")[0].replace(/^\s/,""):null},e.prototype.clearItem=function(){var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var t=e.length;t--;)document.cookie=e[t]+"=0;path=/;expires="+new Date(0).toUTCString()},e.prototype.onOutOfQuota=function(){return 4096},e}();e.CookieProvider=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function e(){}return e.getInstance=function(){return new e},e.prototype.setItem=function(e,t){localStorage.setItem(e.toString(),t)},e.prototype.getItem=function(e){return localStorage.getItem(e?e.toString():"")},e.prototype.removeItem=function(e){localStorage.removeItem(e.toString())},e.prototype.clearItem=function(){localStorage.clear()},e.prototype.onOutOfQuota=function(){return JSON.stringify(localStorage).length},e}();e.LocalStorageProvider=t}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){var t=function(){function t(){if(this.script=document.createElement("script"),this.head=document.getElementsByTagName("head")[0],e.Transportations._TransportType=e.Socket.WEBSOCKET,"WebSocket"in window&&"ArrayBuffer"in window&&3===WebSocket.prototype.CLOSED&&!window.WEB_XHR_POLLING){var t=window.SCHEMETYPE?window.SCHEMETYPE+"://cdn.ronghub.com/protobuf-2.1.1.min.js":"//cdn.ronghub.com/protobuf-2.1.1.min.js";this.script.src=t,this.head.appendChild(this.script)}else e.Transportations._TransportType="xhr-polling",window.Modules=Polling}return t}();e.FeatureDectector=t,"interactive"==document.readyState||"loading"==document.readyState||"complete"==document.readyState?new t:document.addEventListener?document.addEventListener("DOMContentLoaded",function(){document.removeEventListener("DOMContentLoaded",arguments.callee,!1),new t},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"interactive"!=document.readyState&&"loading"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",arguments.callee),new t)})}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(RongIMLib){var FeaturePatcher=function(){function FeaturePatcher(){}return FeaturePatcher.prototype.patchAll=function(){this.patchJSON(),this.patchForEach()},FeaturePatcher.prototype.patchForEach=function(){Array.forEach||(Array.forEach=function(e,t){for(var n=0;n<e.length;n++)t.call(e,e[n],n,e)})},FeaturePatcher.prototype.patchJSON=function(){window.JSON||(window.JSON=function(){function JSON(){}return JSON.parse=function(sJSON){return eval("("+sJSON+")")},JSON.stringify=function(e){return this.str("",{"":e})},JSON.str=function(e,t){var n,o,s,r,i,a=t[e],c=this;switch(a&&"object"==typeof a&&"function"==typeof a.toJSON&&(a=a.toJSON(e)),typeof a){case"string":return c.quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";if(i=[],"[object Array]"===Object.prototype.toString.apply(a)){for(r=a.length,n=0;r>n;n+=1)i[n]=c.str(n,a)||"null";return s=0===i.length?"[]":"["+i.join(",")+"]"}for(o in a)Object.prototype.hasOwnProperty.call(a,o)&&(s=c.str(o,a),s&&i.push(c.quote(o)+":"+s));return s=0===i.length?"{}":"{"+i.join(",")+"}"}},JSON.quote=function(e){var t=this;return t.rx_escapable.lastIndex=0,t.rx_escapable.test(e)?'"'+e.replace(t.rx_escapable,function(e){var n=t.meta[e];return"string"==typeof n?n:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'},JSON.rx_escapable=new RegExp('[\\"\\\\"\x00----\u2028--\ufeff-]',"g"),JSON.meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"''":"\\''","\\":"\\\\"},JSON}())},FeaturePatcher}();RongIMLib.FeaturePatcher=FeaturePatcher}(RongIMLib||(RongIMLib={}));var RongIMLib;!function(e){(function(){function e(){}return e.prototype.load=function(e,t,n){var o=document.createElement("script");o.async=!0,t&&(o.addEventListener?o.addEventListener("load",function(e){var n=e.target||e.srcElement;t(n.src)},!1):o.readyState&&(o.onreadystatechange=function(e){var n=e.srcElement;t(n.src)})),n&&(o.onerror=function(e){var t=e.target||e.srcElement;n(t.src)}),(document.head||document.getElementsByTagName("head")[0]).appendChild(o),o.src=e},e})()}(RongIMLib||(RongIMLib={}));